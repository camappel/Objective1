[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Barrier Book",
    "section": "",
    "text": "Barrier Book is an interactive documentation and analysis site exploring the functioning, operation, meteorological context, and flood defense performance of major storm surge barriers.\nThis site presents: - Barrier closure histories: Analyzing when and why flood barriers were closed over the past decades. - Tidal and water level data: Processing long-term tide gauge observations and predicted astronomical tides. - Meteorological conditions during storms: Examining wind, pressure, and storm data associated with each closure. - Spatio-temporal characteristics: Exploring the spatial and temporal patterns of storm events and barrier operations. - Visualizations: Comprehensive figures showing barrier operations, extreme sea levels, meteorological extremes, and trends. - Workflows and notebooks: Step-by-step technical analyses and reproducible code using Python and Quarto.\nBarrier Book is designed for researchers, civil engineers, and decision-makers interested in flood risk, coastal defense, and climate adaptation.\nAll analysis code and workflows are open and reproducible, with data sourced from official Dutch and UK agencies."
  },
  {
    "objectID": "thames.html",
    "href": "thames.html",
    "title": "Thames Barrier",
    "section": "",
    "text": "This document provides a complete analysis workflow for the Thames barrier system, combining barrier closure analysis, tide gauge data processing, tidal analysis, and visualization. The analysis covers the period from 1986 to 2024 and includes:\nWater years run from July 1 to June 30, which is more appropriate for coastal flood analysis than calendar years."
  },
  {
    "objectID": "thames.html#analysis",
    "href": "thames.html#analysis",
    "title": "Thames Barrier",
    "section": "Analysis",
    "text": "Analysis\n\n# 2. Count closures per water year (July 1 to July 1)\nOCS = []  # Will store [index, year, year+1, num_closures]\nYT = []   # Will store year labels like \"1986/87\"\n\nfor co, y in enumerate(Y, start=1):\n    # Find closures between July 1 of year y and July 1 of year y+1\n    start_date = datetime(y, 7, 1, 0, 0, 0)\n    end_date = datetime(y + 1, 7, 1, 0, 0, 0)\n    \n    # Count closures in this water year\n    closures_in_year = [d for d in OCD if start_date &lt;= d &lt; end_date]\n    num_closures = len(closures_in_year)\n    \n    OCS.append([co, y, y + 1, num_closures])\n    \n    # Create year label (e.g., \"1986/87\")\n    year_str = str(y + 1)\n    YT.append(f\"{y}/{year_str[2:]}\")\n\nOCS = np.array(OCS)\n\nprint(f\"\\nClosures per water year calculated for {len(OCS)} years\")\nprint(f\"  Total closures: {np.sum(OCS[:, 3])}\")\n\n\nClosures per water year calculated for 39 years\n  Total closures: 219\n\n\n\n# 3. Calculate statistics\nE = np.array([\n    np.min(OCS[:, 3]),      # Minimum closures per year\n    np.mean(OCS[:, 3]),     # Mean closures per year\n    np.max(OCS[:, 3]),      # Maximum closures per year\n    np.sum(OCS[:, 3])       # Total closures\n])\n\nprint(f\"\\nClosure statistics:\")\nprint(f\"  Min per year: {E[0]:.1f}\")\nprint(f\"  Mean per year: {E[1]:.2f}\")\nprint(f\"  Max per year: {E[2]:.1f}\")\nprint(f\"  Total: {E[3]:.0f}\")\n\n\nClosure statistics:\n  Min per year: 0.0\n  Mean per year: 5.62\n  Max per year: 50.0\n  Total: 219\n\n\n\n# 4. Save data\noutput_file = os.path.join(output_dir, 'mast1_thames.pkl')\nwith open(output_file, 'wb') as f:\n    pickle.dump({\n        'OCD': OCD,\n        'OCS': OCS,\n        'E': E,\n        'YT': YT\n    }, f)\nprint(f\"\\nData saved to {output_file}\")\n\n\nData saved to output/mast1_thames.pkl"
  },
  {
    "objectID": "thames.html#visualization",
    "href": "thames.html#visualization",
    "title": "Thames Barrier",
    "section": "Visualization",
    "text": "Visualization\nThis bar chart shows the number of barrier closures per water year from 1986/87 to 2024/25. The Thames Barrier closes when water levels exceed a threshold, typically during storm surge events.\n\nfig, ax = plt.subplots(figsize=(12, 6))\nax.bar(OCS[:, 0], OCS[:, 3], color='black')\nax.set_xlim(0.2, len(OCS) + 0.8)\nax.set_xticks(range(1, len(OCS) + 1))\nax.set_xticklabels(YT, rotation=90)\n# Note: y-axis limit may need adjustment based on actual data\nmax_closures = int(np.max(OCS[:, 3])) + 1\nax.set_ylim(0, max_closures)\nax.set_yticks(range(0, max_closures + 1, max(1, max_closures // 10)))\nax.set_ylabel('Number of closures', fontweight='bold', fontsize=18)\nax.set_title('Thames Barrier', fontweight='bold', fontsize=18)\nax.grid(True, alpha=0.3)\nax.tick_params(labelsize=16)\n\nplt.tight_layout()\nplt.show()\n\n# Save figure\nfig_file = os.path.join(output_dir, 'master1_thames_closures.png')\nplt.savefig(fig_file, dpi=150, bbox_inches='tight')\nprint(f\"\\nFigure saved to {fig_file}\")\n\n\n\n\nNumber of Thames Barrier closures per water year (July 1 to June 30), 1986-2024\n\n\n\n\n\nFigure saved to output/master1_thames_closures.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;\n\n\nThe following table lists all barrier closure dates, which correspond to storm events that triggered the Thames Barrier.\n\n# Create DataFrame with closure dates\nstorms_df = pd.DataFrame({\n    'Closure Date': [d.strftime('%Y-%m-%d %H:%M') if isinstance(d, datetime) else str(d) for d in OCD],\n    'Year': [d.year if isinstance(d, datetime) else None for d in OCD],\n    'Month': [d.strftime('%B') if isinstance(d, datetime) else None for d in OCD],\n    'YearMonth': [(d.year, d.month) if isinstance(d, datetime) else None for d in OCD]\n})\n\n# Add water year information\ndef get_water_year(date):\n    \"\"\"Determine water year (July 1 to June 30)\"\"\"\n    if isinstance(date, datetime):\n        if date.month &gt;= 7:\n            return f\"{date.year}/{str(date.year + 1)[2:]}\"\n        else:\n            return f\"{date.year - 1}/{str(date.year)[2:]}\"\n    return None\n\nstorms_df['Water Year'] = [get_water_year(d) for d in OCD]\n\n# Create index that groups storms by year and month\n# Storms in the same year and month get the same index\nunique_year_months = storms_df['YearMonth'].unique()\nyear_month_to_index = {ym: idx + 1 for idx, ym in enumerate(sorted(unique_year_months))}\nstorms_df['Event'] = storms_df['YearMonth'].map(year_month_to_index)\n\n# Reorder columns (Index first, then remove YearMonth helper column)\nstorms_df = storms_df[['Event', 'Closure Date', 'Water Year', 'Year', 'Month']]\n\n# Display table\nprint(f\"\\nTotal number of closures: {len(storms_df)}\")\nstorms_df\n\n\nTotal number of closures: 221\n\n\n\n\n\n\nComplete list of Thames Barrier closures (storm events), 1986-2024\n\n\n\nEvent\nClosure Date\nWater Year\nYear\nMonth\n\n\n\n\n0\n1\n1983-02-01 00:00\n1982/83\n1983\nFebruary\n\n\n1\n2\n1985-12-26 00:00\n1985/86\n1985\nDecember\n\n\n2\n3\n1987-03-29 00:00\n1986/87\n1987\nMarch\n\n\n3\n4\n1988-12-24 00:00\n1988/89\n1988\nDecember\n\n\n4\n5\n1990-02-12 00:00\n1989/90\n1990\nFebruary\n\n\n...\n...\n...\n...\n...\n...\n\n\n216\n83\n2024-03-11 00:00\n2023/24\n2024\nMarch\n\n\n217\n83\n2024-03-14 00:00\n2023/24\n2024\nMarch\n\n\n218\n83\n2024-03-14 00:00\n2023/24\n2024\nMarch\n\n\n219\n84\n2024-04-08 00:00\n2023/24\n2024\nApril\n\n\n220\n84\n2024-04-09 00:00\n2023/24\n2024\nApril\n\n\n\n\n221 rows × 5 columns"
  },
  {
    "objectID": "thames.html#save-results-part-2",
    "href": "thames.html#save-results-part-2",
    "title": "Thames Barrier",
    "section": "Save Results (Part 2)",
    "text": "Save Results (Part 2)\nSave the combined time series to a pickle file for use in subsequent analyses.\n\n# Save data\noutput_file = os.path.join(output_dir, 'mast2_thames.pkl')\nwith open(output_file, 'wb') as f:\n    pickle.dump({\n        'TSP': TSP,\n        'WLP': WLP,\n        'TSCHECK': TSP  # Reference time series\n    }, f)\nprint(f\"\\nData saved to {output_file}\")\n\n\nData saved to output/mast2_thames.pkl"
  },
  {
    "objectID": "thames.html#visualization-part-2",
    "href": "thames.html#visualization-part-2",
    "title": "Thames Barrier",
    "section": "Visualization (Part 2)",
    "text": "Visualization (Part 2)\nThis figure shows the combined tide gauge water level time series from 1986 to 2023 at 10-minute intervals. The data shows tidal variations, storm surges, and long-term water level patterns over the period.\n\nfig, ax = plt.subplots(figsize=(14, 6))\nax.plot(TSP, WLP, 'b', linewidth=0.5)\nax.set_xlabel('Date', fontweight='bold', fontsize=20)\nax.set_ylabel('Water level (m NAP)', fontweight='bold', fontsize=20)\nax.grid(True, alpha=0.3)\nax.tick_params(labelsize=16)\n\nplt.tight_layout()\nplt.show()\n\n# Save figure\nfig_file = os.path.join(output_dir, 'master2_thames_tide_gauge.png')\nplt.savefig(fig_file, dpi=150, bbox_inches='tight')\nprint(f\"\\nFigure saved to {fig_file}\")\n\n\n\n\nCombined tide gauge water level time series for the Thames, 1986-2023. Data at 10-minute intervals.\n\n\n\n\n\nFigure saved to output/master2_thames_tide_gauge.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;"
  },
  {
    "objectID": "thames.html#setup-and-configuration",
    "href": "thames.html#setup-and-configuration",
    "title": "Thames Barrier",
    "section": "Setup and Configuration",
    "text": "Setup and Configuration\n\nimport numpy as np\nimport pandas as pd\nimport pickle\nimport matplotlib.pyplot as plt\nfrom datetime import datetime\nfrom pytides.tide import Tide\nimport os\n\n# Configuration\nY = list(range(1986, 2024))  # Years 1986 to 2023\nth = 60  # Data quality threshold (percentage)\nlat = 51.5  # Latitude for tidal analysis (Thames Barrier approximate location)\noutput_dir = 'output'\n\n# Create output directory if it doesn't exist\nos.makedirs(output_dir, exist_ok=True)\n\nprint(f\"Analysis configuration:\")\nprint(f\"  Years: {Y[0]} to {Y[-1]} ({len(Y)} years)\")\nprint(f\"  Data quality threshold: {th}%\")\nprint(f\"  Latitude: {lat}°\")\n\nAnalysis configuration:\n  Years: 1986 to 2023 (38 years)\n  Data quality threshold: 60%\n  Latitude: 51.5°"
  },
  {
    "objectID": "thames.html#load-tide-gauge-data",
    "href": "thames.html#load-tide-gauge-data",
    "title": "Thames Barrier",
    "section": "Load Tide Gauge Data",
    "text": "Load Tide Gauge Data\n\nprint(\"Loading tide gauge data...\")\nmast2_file = os.path.join(output_dir, 'mast2_thames.pkl')\nif not os.path.exists(mast2_file):\n    raise FileNotFoundError(\n        f\"Required file {mast2_file} not found. \"\n        \"Please run Part 2 (Tide Gauge Data Processing) first to generate the required data file.\"\n    )\nwith open(mast2_file, 'rb') as f:\n    data = pickle.load(f)\n    TSP = data['TSP']\n    WLP = data['WLP']\n\n# Convert to numpy arrays if needed\nTSP = np.array(TSP)\nWLP = np.array(WLP)\n\nprint(f\"Loaded {len(TSP):,} data points\")\nprint(f\"  Start: {TSP[0]}\")\nprint(f\"  End: {TSP[-1]}\")\nprint(f\"  Valid data: {np.sum(~np.isnan(WLP)):,} points ({100*np.sum(~np.isnan(WLP))/len(WLP):.1f}%)\")\n\nLoading tide gauge data...\nLoaded 1,998,576 data points\n  Start: 1986-01-01 00:00:00\n  End: 2023-12-31 23:50:00\n  Valid data: 1,124,886 points (56.3%)"
  },
  {
    "objectID": "thames.html#calculate-data-quality-per-year",
    "href": "thames.html#calculate-data-quality-per-year",
    "title": "Thames Barrier",
    "section": "Calculate Data Quality Per Year",
    "text": "Calculate Data Quality Per Year\n\nprint(\"\\nCalculating data quality per year...\")\nDQ = []\n\nfor y in Y:\n    # Find data points in this calendar year (Jan 1 to Jan 1 next year)\n    start_date = datetime(y, 1, 1, 0, 0, 0)\n    end_date = datetime(y + 1, 1, 1, 0, 0, 0)\n    mask = (TSP &gt;= start_date) & (TSP &lt; end_date)\n    j = np.where(mask)[0]\n    \n    if len(j) == 0:\n        quality = 0\n    else:\n        # Count non-NaN values\n        k = np.where(~np.isnan(WLP[j]))[0]\n        quality = (len(k) / len(j)) * 100\n    \n    # Initialize with 3 columns: [year, quality, reference_year]\n    # reference_year will be filled in during tidal analysis\n    DQ.append([y, quality, np.nan])\n\nDQ = np.array(DQ)\n\n# Display summary statistics\nprint(f\"\\nData quality summary:\")\nprint(f\"  Range: {np.min(DQ[:, 1]):.1f}% to {np.max(DQ[:, 1]):.1f}%\")\nprint(f\"  Mean: {np.mean(DQ[:, 1]):.1f}%\")\nprint(f\"  Years with quality &gt;= {th}%: {np.sum(DQ[:, 1] &gt;= th)}/{len(Y)}\")\n\n\nCalculating data quality per year...\n\nData quality summary:\n  Range: 0.0% to 100.0%\n  Mean: 56.3%\n  Years with quality &gt;= 60%: 17/38"
  },
  {
    "objectID": "thames.html#tidal-analysis-and-prediction",
    "href": "thames.html#tidal-analysis-and-prediction",
    "title": "Thames Barrier",
    "section": "Tidal Analysis and Prediction",
    "text": "Tidal Analysis and Prediction\nFor each target year, the analysis determines a reference year, extracts data, performs harmonic decomposition, and generates predictions.\n\nprint(\"\\nPerforming tidal analysis and prediction...\")\nTSP2 = []\nTIP = []\n\nfor co, y in enumerate(Y):\n    print(f\"  Processing year {y} ({co+1}/{len(Y)})...\")\n    \n    # Determine reference year\n    if DQ[co, 1] &gt;= th:\n        # Use target year as reference\n        yr = y\n        DQ[co, 2] = yr\n    else:\n        # Find nearest year with quality &gt;= threshold\n        # Calculate distances from target year\n        distances = np.abs(DQ[:, 0] - y)\n        \n        # Filter to only years with quality &gt;= threshold\n        good_mask = DQ[:, 1] &gt;= th\n        \n        if np.any(good_mask):\n            # Get distances for good years only\n            good_distances = distances[good_mask]\n            good_indices = np.where(good_mask)[0]\n            \n            # Find nearest good year\n            nearest_idx = good_indices[np.argmin(good_distances)]\n            yr = int(DQ[nearest_idx, 0])\n        else:\n            # Fallback: use year with best quality\n            best_idx = np.argmax(DQ[:, 1])\n            yr = int(DQ[best_idx, 0])\n        \n        DQ[co, 2] = yr\n    \n    # Extract reference year data (1 year + 1 day for analysis)\n    ref_start = datetime(yr, 1, 1, 0, 0, 0)\n    ref_end = datetime(yr + 1, 1, 2, 0, 0, 0)  # +1 day\n    \n    mask_ref = (TSP &gt;= ref_start) & (TSP &lt; ref_end)\n    j_ref = np.where(mask_ref)[0]\n    \n    if len(j_ref) == 0:\n        print(f\"    Warning: No data found for reference year {yr}\")\n        continue\n    \n    # Get water levels and times for reference year\n    WLP_ref = WLP[j_ref]\n    TSP_ref = TSP[j_ref]\n    \n    # Remove NaN values for pytides analysis\n    valid_mask = ~np.isnan(WLP_ref)\n    WLP_clean = WLP_ref[valid_mask]\n    TSP_clean = TSP_ref[valid_mask]\n    \n    if len(WLP_clean) &lt; 1000:  # Need sufficient data for analysis\n        print(f\"    Warning: Insufficient data for reference year {yr} ({len(WLP_clean)} points)\")\n        continue\n    \n    # Perform tidal analysis using pytides\n    try:\n        tide_model = Tide.decompose(\n            heights=WLP_clean,\n            t=TSP_clean\n        )\n        print(f\"    Analyzed {len(WLP_clean):,} points from reference year {yr}\")\n    except Exception as e:\n        print(f\"    Error in tidal analysis for year {y}: {e}\")\n        continue\n    \n    # Generate prediction timestamps for target year (10-minute intervals)\n    pred_start = datetime(y, 1, 1, 0, 0, 0)\n    pred_end = datetime(y, 12, 31, 23, 50, 0)\n    tsp2 = pd.date_range(start=pred_start, end=pred_end, freq='10min').to_pydatetime()\n    \n    # Predict tides\n    try:\n        tip = tide_model.at(tsp2)\n        TIP.extend(tip)\n        TSP2.extend(tsp2)\n        print(f\"    Predicted {len(tip):,} points for year {y}\")\n    except Exception as e:\n        print(f\"    Error in prediction for year {y}: {e}\")\n        continue\n\n# Convert to numpy arrays\nTSP2 = np.array(TSP2)\nTIP = np.array(TIP)\n\nprint(f\"\\nTotal predictions: {len(TIP):,} points\")\nif len(TIP) &gt; 0:\n    print(f\"  Start: {TSP2[0]}\")\n    print(f\"  End: {TSP2[-1]}\")\n\n\nPerforming tidal analysis and prediction...\n  Processing year 1986 (1/38)...\n    Analyzed 52,704 points from reference year 1993\n    Predicted 52,560 points for year 1986\n  Processing year 1987 (2/38)...\n    Analyzed 52,704 points from reference year 1993\n    Predicted 52,560 points for year 1987\n  Processing year 1988 (3/38)...\n    Analyzed 52,704 points from reference year 1993\n    Predicted 52,704 points for year 1988\n  Processing year 1989 (4/38)...\n    Analyzed 52,704 points from reference year 1993\n    Predicted 52,560 points for year 1989\n  Processing year 1990 (5/38)...\n    Analyzed 52,704 points from reference year 1993\n    Predicted 52,560 points for year 1990\n  Processing year 1991 (6/38)...\n    Analyzed 52,704 points from reference year 1993\n    Predicted 52,560 points for year 1991\n  Processing year 1992 (7/38)...\n    Analyzed 52,704 points from reference year 1993\n    Predicted 52,704 points for year 1992\n  Processing year 1993 (8/38)...\n    Analyzed 52,704 points from reference year 1993\n    Predicted 52,560 points for year 1993\n  Processing year 1994 (9/38)...\n    Analyzed 52,297 points from reference year 1994\n    Predicted 52,560 points for year 1994\n  Processing year 1995 (10/38)...\n    Analyzed 52,704 points from reference year 1995\n    Predicted 52,560 points for year 1995\n  Processing year 1996 (11/38)...\n    Analyzed 51,828 points from reference year 1996\n    Predicted 52,704 points for year 1996\n  Processing year 1997 (12/38)...\n    Analyzed 51,974 points from reference year 1997\n    Predicted 52,560 points for year 1997\n  Processing year 1998 (13/38)...\n    Analyzed 52,704 points from reference year 1998\n    Predicted 52,560 points for year 1998\n  Processing year 1999 (14/38)...\n    Analyzed 51,878 points from reference year 1999\n    Predicted 52,560 points for year 1999\n  Processing year 2000 (15/38)...\n    Analyzed 49,732 points from reference year 2000\n    Predicted 52,704 points for year 2000\n  Processing year 2001 (16/38)...\n    Analyzed 40,906 points from reference year 2001\n    Predicted 52,560 points for year 2001\n  Processing year 2002 (17/38)...\n    Analyzed 37,410 points from reference year 2002\n    Predicted 52,560 points for year 2002\n  Processing year 2003 (18/38)...\n    Analyzed 52,625 points from reference year 2003\n    Predicted 52,560 points for year 2003\n  Processing year 2004 (19/38)...\n    Analyzed 52,848 points from reference year 2004\n    Predicted 52,704 points for year 2004\n  Processing year 2005 (20/38)...\n    Analyzed 52,704 points from reference year 2005\n    Predicted 52,560 points for year 2005\n  Processing year 2006 (21/38)...\n    Analyzed 52,249 points from reference year 2006\n    Predicted 52,560 points for year 2006\n  Processing year 2007 (22/38)...\n    Analyzed 39,679 points from reference year 2007\n    Predicted 52,560 points for year 2007\n  Processing year 2008 (23/38)...\n    Analyzed 33,152 points from reference year 2008\n    Predicted 52,704 points for year 2008\n  Processing year 2009 (24/38)...\n    Analyzed 33,152 points from reference year 2008\n    Predicted 52,560 points for year 2009\n  Processing year 2010 (25/38)...\n    Analyzed 33,152 points from reference year 2008\n    Predicted 52,560 points for year 2010\n  Processing year 2011 (26/38)...\n    Analyzed 33,152 points from reference year 2008\n    Predicted 52,560 points for year 2011\n  Processing year 2012 (27/38)...\n    Analyzed 33,152 points from reference year 2008\n    Predicted 52,704 points for year 2012\n  Processing year 2013 (28/38)...\n    Analyzed 33,152 points from reference year 2008\n    Predicted 52,560 points for year 2013\n  Processing year 2014 (29/38)...\n    Analyzed 33,152 points from reference year 2008\n    Predicted 52,560 points for year 2014\n  Processing year 2015 (30/38)...\n    Analyzed 33,152 points from reference year 2008\n    Predicted 52,560 points for year 2015\n  Processing year 2016 (31/38)...\n    Analyzed 47,468 points from reference year 2022\n    Predicted 52,704 points for year 2016\n  Processing year 2017 (32/38)...\n    Analyzed 47,468 points from reference year 2022\n    Predicted 52,560 points for year 2017\n  Processing year 2018 (33/38)...\n    Analyzed 47,468 points from reference year 2022\n    Predicted 52,560 points for year 2018\n  Processing year 2019 (34/38)...\n    Analyzed 47,468 points from reference year 2022\n    Predicted 52,560 points for year 2019\n  Processing year 2020 (35/38)...\n    Analyzed 47,468 points from reference year 2022\n    Predicted 52,704 points for year 2020\n  Processing year 2021 (36/38)...\n    Analyzed 47,468 points from reference year 2022\n    Predicted 52,560 points for year 2021\n  Processing year 2022 (37/38)...\n    Analyzed 47,468 points from reference year 2022\n    Predicted 52,560 points for year 2022\n  Processing year 2023 (38/38)...\n    Analyzed 47,468 points from reference year 2022\n    Predicted 52,560 points for year 2023\n\nTotal predictions: 1,998,576 points\n  Start: 1986-01-01 00:00:00\n  End: 2023-12-31 23:50:00"
  },
  {
    "objectID": "thames.html#save-results-part-3",
    "href": "thames.html#save-results-part-3",
    "title": "Thames Barrier",
    "section": "Save Results (Part 3)",
    "text": "Save Results (Part 3)\n\noutput_file = os.path.join(output_dir, 'mast3_thames.pkl')\nwith open(output_file, 'wb') as f:\n    pickle.dump({\n        'TSP': TSP,\n        'WLP': WLP,\n        'TIP': TIP,\n        'TSP2': TSP2,\n        'DQ': DQ\n    }, f)\nprint(f\"Data saved to {output_file}\")\n\nData saved to output/mast3_thames.pkl"
  },
  {
    "objectID": "thames.html#visualization-part-3",
    "href": "thames.html#visualization-part-3",
    "title": "Thames Barrier",
    "section": "Visualization (Part 3)",
    "text": "Visualization (Part 3)\nThis figure compares observed water levels (blue) with predicted astronomical tides (red) from harmonic analysis. The predicted tides represent the astronomical component only, while observed water levels include both tides and meteorological effects.\n\nfig, ax = plt.subplots(figsize=(14, 6))\nax.plot(TSP2, TIP, 'r', linewidth=0.5, label='Predicted tide', alpha=0.7)\nax.plot(TSP, WLP, 'b', linewidth=0.5, label='Observed water level', alpha=0.7)\nax.set_xlabel('Date', fontweight='bold', fontsize=16)\nax.set_ylabel('Level (m NAP)', fontweight='bold', fontsize=16)\nax.legend(fontsize=14)\nax.grid(True, alpha=0.3)\nax.tick_params(labelsize=14)\n\nplt.tight_layout()\nplt.show()\n\n# Save figure\nfig_file = os.path.join(output_dir, 'master3_thames_tidal_analysis.png')\nplt.savefig(fig_file, dpi=150, bbox_inches='tight')\nprint(f\"\\nFigure saved to {fig_file}\")\n\n\n\n\nComparison of observed water levels (blue) and predicted astronomical tides (red) for the Thames, 1986-2023\n\n\n\n\n\nFigure saved to output/master3_thames_tidal_analysis.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;"
  },
  {
    "objectID": "thames.html#introduction",
    "href": "thames.html#introduction",
    "title": "Thames Barrier",
    "section": "Introduction",
    "text": "Introduction\nThis section plots time-series of predicted high waters and barrier closures for the Thames. The analysis:\n\nLoads barrier closure dates and tide gauge data from previous analyses\nCreates a visualization showing:\n\nBarrier closure dates as vertical dashed lines\nPredicted astronomical tides (TIP)\nObserved water levels (WLP)\nThe difference between observed and predicted levels (surge component)\n\n\nThis visualization helps identify when barrier closures occurred relative to predicted high waters and actual water levels."
  },
  {
    "objectID": "thames.html#setup-and-configuration-1",
    "href": "thames.html#setup-and-configuration-1",
    "title": "Thames Barrier",
    "section": "Setup and Configuration",
    "text": "Setup and Configuration\n\nimport numpy as np\nimport pandas as pd\nimport pickle\nimport matplotlib.pyplot as plt\nfrom datetime import datetime\nimport os\n\n# Output directory\noutput_dir = 'output'\nos.makedirs(output_dir, exist_ok=True)\n\nprint(f\"Analysis configuration:\")\nprint(f\"  Output directory: {output_dir}\")\n\nAnalysis configuration:\n  Output directory: output"
  },
  {
    "objectID": "thames.html#load-data",
    "href": "thames.html#load-data",
    "title": "Thames Barrier",
    "section": "Load Data",
    "text": "Load Data\n\n# Load barrier closure data from master1\nprint(\"Loading barrier closure data...\")\nmast1_file = os.path.join(output_dir, 'mast1_thames.pkl')\nif not os.path.exists(mast1_file):\n    raise FileNotFoundError(\n        f\"Required file {mast1_file} not found. \"\n        \"Please run Part 1 (Barrier Closure Analysis) first to generate the required data file.\"\n    )\nwith open(mast1_file, 'rb') as f:\n    data1 = pickle.load(f)\n    OCD = data1['OCD']  # Observed closure dates\n\n# Load tide gauge and tidal prediction data from master3\nprint(\"Loading tide gauge and tidal prediction data...\")\nmast3_file = os.path.join(output_dir, 'mast3_thames.pkl')\nif not os.path.exists(mast3_file):\n    raise FileNotFoundError(\n        f\"Required file {mast3_file} not found. \"\n        \"Please run Part 1, Part 2, and Part 3 first to generate the required data files.\"\n    )\nwith open(mast3_file, 'rb') as f:\n    data3 = pickle.load(f)\n    TSP = data3['TSP']  # Time series for observed water levels\n    TSP2 = data3['TSP2']  # Time series for predictions\n    TIP = data3['TIP']  # Predicted tides\n    WLP = data3['WLP']  # Observed water levels\n\n# Convert to numpy arrays if needed\nOCD = np.array(OCD)\nTSP = np.array(TSP)\nTSP2 = np.array(TSP2)\nTIP = np.array(TIP)\nWLP = np.array(WLP)\n\nprint(f\"\\nData loaded:\")\nprint(f\"  Closure dates: {len(OCD)} closures\")\nif len(OCD) &gt; 0:\n    print(f\"    First closure: {OCD[0]}\")\n    print(f\"    Last closure: {OCD[-1]}\")\nprint(f\"  Time series points (observed): {len(TSP):,}\")\nprint(f\"  Time series points (predictions): {len(TSP2):,}\")\nprint(f\"  Predicted tides: {len(TIP):,}\")\nprint(f\"  Observed water levels: {len(WLP):,}\")\n\nLoading barrier closure data...\nLoading tide gauge and tidal prediction data...\n\nData loaded:\n  Closure dates: 221 closures\n    First closure: 1983-02-01 00:00:00\n    Last closure: 2024-04-09 00:00:00\n  Time series points (observed): 1,998,576\n  Time series points (predictions): 1,998,576\n  Predicted tides: 1,998,576\n  Observed water levels: 1,998,576"
  },
  {
    "objectID": "thames.html#figure---predicted-high-waters-and-closures",
    "href": "thames.html#figure---predicted-high-waters-and-closures",
    "title": "Thames Barrier",
    "section": "Figure - Predicted High Waters and Closures",
    "text": "Figure - Predicted High Waters and Closures\nThis figure shows predicted astronomical tides (red), observed water levels (blue), the difference between them (green), and barrier closure dates (vertical dashed magenta lines). The difference (WLP-TIP) represents the non-tidal component, primarily storm surge.\n\nfig, ax = plt.subplots(figsize=(14, 8))\n\n# Plot vertical lines for barrier closure dates\nfor i in range(len(OCD)):\n    ax.axvline(OCD[i], color='m', linestyle='--', linewidth=2, alpha=0.7)\n\n# Check if we have predictions\nif len(TIP) &gt; 0 and len(TSP2) &gt; 0:\n    # Plot predicted tides (TIP) - use TSP2 for time axis\n    ax.plot(TSP2, TIP, 'r', linewidth=1, label='Predicted tide (TIP)', alpha=0.8)\n    \n    # For observed water levels, plot the full time series\n    ax.plot(TSP, WLP, 'b', linewidth=1, label='Observed water level (WLP)', alpha=0.8)\n    \n    # For surge calculation, interpolate TIP to match TSP timestamps using pandas\n    # Find overlapping time period\n    mask_overlap = (TSP &gt;= TSP2[0]) & (TSP &lt;= TSP2[-1])\n    if np.any(mask_overlap):\n        TSP_overlap = TSP[mask_overlap]\n        WLP_overlap = WLP[mask_overlap]\n        # Use pandas for interpolation\n        df_tip = pd.Series(TIP, index=pd.DatetimeIndex(TSP2))\n        # Reindex to overlap timestamps and interpolate\n        tip_interp = df_tip.reindex(pd.DatetimeIndex(TSP_overlap), method='nearest', \n                                    tolerance=pd.Timedelta(minutes=15))\n        # Calculate surge where we have both values\n        valid_mask = ~tip_interp.isna()\n        if np.any(valid_mask):\n            surge = WLP_overlap[valid_mask] - tip_interp.values[valid_mask]\n            ax.plot(TSP_overlap[valid_mask], surge, 'g', \n                   linewidth=1, label='Surge (WLP - TIP)', alpha=0.8)\nelse:\n    # If no predictions, just plot observed water levels\n    print(\"Warning: No tidal predictions available. Plotting only observed water levels.\")\n    ax.plot(TSP, WLP, 'b', linewidth=1, label='Observed water level (WLP)', alpha=0.8)\n\n# Formatting\nax.grid(True, alpha=0.3)\nax.set_xlabel('Date', fontweight='bold', fontsize=16)\nax.set_ylabel('Level (m)', fontweight='bold', fontsize=16)\nax.set_ylim(-3, 4)\nax.legend(fontsize=14, loc='best')\nax.tick_params(labelsize=14)\n\nplt.tight_layout()\nplt.show()\n\n# Save figure\nfig_file = os.path.join(output_dir, 'master4_thames_predicted_high_waters.png')\nplt.savefig(fig_file, dpi=150, bbox_inches='tight')\nprint(f\"\\nFigure saved to {fig_file}\")\n\n\n\n\nPredicted high waters, observed water levels, and barrier closures for the Thames\n\n\n\n\n\nFigure saved to output/master4_thames_predicted_high_waters.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;"
  },
  {
    "objectID": "thames.html#part-1-barrier-closure-analysis",
    "href": "thames.html#part-1-barrier-closure-analysis",
    "title": "Thames Barrier",
    "section": "Part 1: Barrier Closure Analysis",
    "text": "Part 1: Barrier Closure Analysis\n\nTotal closures: Recorded across water years 1986/87 to 2024/25\nAnnual statistics: Minimum, mean, and maximum closures per water year\nTemporal patterns: Variability in closure frequency over time"
  },
  {
    "objectID": "thames.html#part-2-tide-gauge-data-processing",
    "href": "thames.html#part-2-tide-gauge-data-processing",
    "title": "Thames Barrier",
    "section": "Part 2: Tide Gauge Data Processing",
    "text": "Part 2: Tide Gauge Data Processing\n\nCombined time series: 1986-2023 at 10-minute intervals\nData sources: Available Thames tide gauge measurements\nData quality: Percentage of valid data points across the time series"
  },
  {
    "objectID": "thames.html#part-3-tidal-analysis",
    "href": "thames.html#part-3-tidal-analysis",
    "title": "Thames Barrier",
    "section": "Part 3: Tidal Analysis",
    "text": "Part 3: Tidal Analysis\n\nData quality: Calculated for each year to determine suitable reference years\nHarmonic analysis: Performed using pytides (Python equivalent of MATLAB’s t_tide)\nPredictions: Generated at 10-minute intervals for the entire period\nSurge calculation: The difference between observed and predicted water levels represents the non-tidal component (surge)"
  },
  {
    "objectID": "thames.html#part-4-visualization",
    "href": "thames.html#part-4-visualization",
    "title": "Thames Barrier",
    "section": "Part 4: Visualization",
    "text": "Part 4: Visualization\n\nClosure timing: When closures occurred relative to predicted high waters\nSurge contribution: The non-tidal component shows how much storm surge contributed to water levels\nTidal vs. meteorological effects: The difference between observed and predicted levels highlights meteorological forcing\n\nThe complete workflow provides a foundation for understanding barrier closure patterns, water level variability, and storm surge dynamics in the Thames estuary. The results can be used for further analysis of individual closure events, surge characteristics, and long-term trends."
  },
  {
    "objectID": "eastern_scheldt.html",
    "href": "eastern_scheldt.html",
    "title": "Eastern Scheldt Barrier",
    "section": "",
    "text": "This document provides a complete analysis workflow for the Eastern Scheldt barrier system, combining barrier closure analysis, tide gauge data processing, tidal analysis, and visualization. The analysis covers the period from 1986 to 2024 and includes:\n\nBarrier Closure Analysis: Loading and analyzing past barrier closure dates, counting closures per water year, and calculating statistics\nTide Gauge Data Processing: Loading and combining tide gauge data from multiple sources (OS4 and RPBU gauges)\nTidal Analysis: Performing harmonic tidal decomposition and generating predicted astronomical tides\nVisualization: Creating comprehensive visualizations showing predicted high waters, observed water levels, and barrier closures\n\nWater years run from July 1 to June 30, which is more appropriate for coastal flood analysis than calendar years.\n\n\nShared utilities and configuration loaded"
  },
  {
    "objectID": "eastern_scheldt.html#analysis",
    "href": "eastern_scheldt.html#analysis",
    "title": "Eastern Scheldt Barrier",
    "section": "Analysis",
    "text": "Analysis\n\n\nLoaded 31 closure datetimes\n  First closure: 1986-10-20 00:00:00\n  Last closure: 2023-12-21 00:00:00\n\nClosures per water year calculated for 39 years\n  Total closures: 31\n\nClosure statistics:\n  Min per year: 0.0\n  Mean per year: 0.79\n  Max per year: 4.0\n  Total: 31\n\nData saved to output/mast1.pkl"
  },
  {
    "objectID": "eastern_scheldt.html#visualization",
    "href": "eastern_scheldt.html#visualization",
    "title": "Eastern Scheldt Barrier",
    "section": "Visualization",
    "text": "Visualization\nThis bar chart shows the number of barrier closures per water year from 1986/87 to 2024/25. The Eastern Scheldt barrier closes when water levels exceed a threshold, typically during storm surge events.\n\n\n\n\n\nNumber of Eastern Scheldt barrier closures per water year (July 1 to June 30), 1986-2024\n\n\n\n\n\nFigure saved to output/master1_closures.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;\n\n\nThe following table lists all barrier closure dates, which correspond to storm events that triggered the Eastern Scheldt barrier.\n\n\n\nTotal number of closures: 31\n\n\n\n\n\n\nComplete list of Eastern Scheldt barrier closures (storm events), 1986-2024\n\n\n\nClosure date\nClosure Date\nWater Year\nYear\nMonth\n\n\nClosure\n\n\n\n\n\n\n\n\n\n0\n1\n1986-10-20 00:00\n1986/87\n1986\nOctober\n\n\n1\n2\n1986-12-19 00:00\n1986/87\n1986\nDecember\n\n\n2\n2\n1986-12-19 00:00\n1986/87\n1986\nDecember\n\n\n3\n3\n1989-02-14 05:40\n1988/89\n1989\nFebruary\n\n\n4\n4\n1990-02-27 23:10\n1989/90\n1990\nFebruary\n\n\n5\n4\n1990-02-27 13:50\n1989/90\n1990\nFebruary\n\n\n6\n4\n1990-02-28 23:40\n1989/90\n1990\nFebruary\n\n\n7\n5\n1990-03-01 00:10\n1989/90\n1990\nMarch\n\n\n8\n6\n1990-09-21 12:00\n1990/91\n1990\nSeptember\n\n\n9\n7\n1990-12-12 05:40\n1990/91\n1990\nDecember\n\n\n10\n7\n1990-12-12 20:10\n1990/91\n1990\nDecember\n\n\n11\n8\n1992-11-11 13:40\n1992/93\n1992\nNovember\n\n\n12\n9\n1993-01-25 15:30\n1992/93\n1993\nJanuary\n\n\n13\n10\n1993-02-21 08:40\n1992/93\n1993\nFebruary\n\n\n14\n11\n1993-11-14 11:10\n1993/94\n1993\nNovember\n\n\n15\n11\n1993-11-15 00:40\n1993/94\n1993\nNovember\n\n\n16\n12\n1994-01-28 10:40\n1993/94\n1994\nJanuary\n\n\n17\n13\n1995-01-02 21:40\n1994/95\n1995\nJanuary\n\n\n18\n13\n1995-01-02 14:20\n1994/95\n1995\nJanuary\n\n\n19\n14\n1996-10-29 11:40\n1996/97\n1996\nOctober\n\n\n20\n15\n2002-10-27 14:30\n2002/03\n2002\nOctober\n\n\n21\n16\n2003-12-21 08:30\n2003/04\n2003\nDecember\n\n\n22\n17\n2004-02-08 13:20\n2003/04\n2004\nFebruary\n\n\n23\n18\n2007-11-09 22:40\n2007/08\n2007\nNovember\n\n\n24\n19\n2013-12-05 22:50\n2013/14\n2013\nDecember\n\n\n25\n20\n2014-10-21 22:30\n2014/15\n2014\nOctober\n\n\n26\n21\n2018-01-03 12:10\n2017/18\n2018\nJanuary\n\n\n27\n22\n2020-02-10 11:09\n2019/20\n2020\nFebruary\n\n\n28\n23\n2022-01-31 10:23\n2021/22\n2022\nJanuary\n\n\n29\n24\n2022-02-21 04:46\n2021/22\n2022\nFebruary\n\n\n30\n25\n2023-12-21 00:00\n2023/24\n2023\nDecember"
  },
  {
    "objectID": "eastern_scheldt.html#tide-gauge-data-processing",
    "href": "eastern_scheldt.html#tide-gauge-data-processing",
    "title": "Eastern Scheldt Barrier",
    "section": "Tide Gauge Data Processing",
    "text": "Tide Gauge Data Processing\nThis section loads and processes raw tide gauge data from the Eastern Scheldt. The analysis:\n\nLoads data from multiple tide gauge files (RPBU and OS4 gauges)\nCleans data by removing invalid values\nCombines time series from different gauges to create a continuous record\nCreates a visualization of the complete water level time series\n\nThe combined time series spans from 1986 to 2023, using OS4 gauge data for the early period (1986-1987) and RPBU gauge data for the main period (1987-2023).\n\n\nData directory: ../2_DATA\nOutput directory: output\n\n\n\nLoad RPBU 1987-2022 Data\nLoad the main tide gauge dataset from the RPBU gauge covering April 1987 to December 2022.\n\n\nLoaded RPBU 1987-2022: 1,878,480 data points\n  Start: 1987-04-15 00:00:00\n  End: 2022-12-31 23:50:00\n  Valid data: 1,876,721 points (99.9%)\n\n\n\n\nLoad RPBU 2023 Data\nLoad the 2023 data from the RPBU gauge to extend the time series.\n\n\nLoaded RPBU 2023: 52,560 data points\n  Start: 2023-01-01 00:00:00\n  End: 2023-12-31 23:50:00\n  Valid data: 52,560 points (100.0%)\n\n\n\n\nLoad OS4 1982-2023 Data\nLoad data from the OS4 gauge, which provides coverage for the early period before RPBU data begins.\n\n\nLoaded OS4 1982-2023: 2,208,960 data points\n  Start: 1982-01-01 00:00:00\n  End: 2023-12-31 23:50:00\n  Valid data: 2,161,485 points (97.9%)\n\n\n\n\nCombine Time Series\nCombine the time series from different gauges to create a continuous record. Use OS4 data for the early period (1986-1987) before RPBU starts, then switch to RPBU data for the main period.\n\n\n\nCombined time series: 1,998,576 data points\n  Start: 1986-01-01 00:00:00\n  End: 2023-12-31 23:50:00\n  Valid data: 1,996,699 points (99.9%)\n  Time span: 13878 days\n\n\nSave the combined time series to a pickle file for use in subsequent analyses.\n\n\n\nData saved to output/mast2.pkl\n\n\n\n\nVisualization\nThis figure shows the combined tide gauge water level time series from 1986 to 2023 at 10-minute intervals. The data combines OS4 gauge measurements (1986-1987) and RPBU gauge measurements (1987-2023) for the Eastern Scheldt. Water levels are shown in meters relative to NAP (Normal Amsterdam Peil, the Dutch reference datum). The time series shows tidal variations, storm surges, and long-term water level patterns over the 38-year period.\n\n\n\n\n\nCombined tide gauge water level time series for the Eastern Scheldt, 1986-2023. Data combines OS4 gauge (1986-1987) and RPBU gauge (1987-2023) measurements at 10-minute intervals.\n\n\n\n\n\nFigure saved to output/master2_tide_gauge.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;"
  },
  {
    "objectID": "eastern_scheldt.html#tidal-analysis",
    "href": "eastern_scheldt.html#tidal-analysis",
    "title": "Eastern Scheldt Barrier",
    "section": "Tidal Analysis",
    "text": "Tidal Analysis\nThis section performs harmonic tidal analysis on tide gauge data from the Eastern Scheldt. The analysis:\n\nCalculates data quality for each year (1986-2023)\nPerforms harmonic tidal decomposition using pytides (replacing MATLAB’s t_tide)\nGenerates tidal predictions for all years\nCompares observed water levels with predicted astronomical tides\n\nThe predicted tides represent only the astronomical component, while observed water levels include both tides and meteorological effects (storm surges, wind setup, etc.).\n\nSetup and Configuration\n\n\nAnalysis configuration:\n  Years: 1986 to 2023 (38 years)\n  Data quality threshold: 60%\n  Latitude: 51.64°\n\n\n\n\nLoad Tide Gauge Data\n\n\nLoading tide gauge data...\nLoaded 1,998,576 data points\n  Start: 1986-01-01 00:00:00\n  End: 2023-12-31 23:50:00\n  Valid data: 1,996,699 points (99.9%)\n\n\n\n\nCalculate Data Quality Per Year\n\n\n\nCalculating data quality per year...\n\nData quality summary:\n  Range: 98.8% to 100.0%\n  Mean: 99.9%\n  Years with quality &gt;= 60%: 38/38\n\n\n\n\nTidal Analysis and Prediction\nFor each target year, the analysis determines a reference year, extracts data, performs harmonic decomposition, and generates predictions.\n\n\n\nLoading existing tidal analysis results...\nLoaded existing results:\n  Total predictions: 1,998,576 points\n  Start: 1986-01-01 00:00:00\n  End: 2023-12-31 23:50:00\n\n\n\n\nData saved to output/mast3.pkl\n\n\n\n\nVisualization\nThis figure compares observed water levels (blue) with predicted astronomical tides (red) from harmonic analysis. The predicted tides represent the astronomical component only, while observed water levels include both tides and meteorological effects.\n\n\n\n\n\nComparison of observed water levels (blue) and predicted astronomical tides (red) for the Eastern Scheldt, 1986-2023\n\n\n\n\n\nFigure saved to output/master3_tidal_analysis.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;"
  },
  {
    "objectID": "eastern_scheldt.html#predicted-high-waters-and-barrier-closures",
    "href": "eastern_scheldt.html#predicted-high-waters-and-barrier-closures",
    "title": "Eastern Scheldt Barrier",
    "section": "Predicted High Waters and Barrier Closures",
    "text": "Predicted High Waters and Barrier Closures\nThis section plots time-series of predicted high waters and barrier closures for the Eastern Scheldt. The analysis:\n\nLoads barrier closure dates and tide gauge data from previous analyses\nCreates a visualization showing:\n\nBarrier closure dates as vertical dashed lines\nPredicted astronomical tides (TIP)\nObserved water levels (WLP)\nThe difference between observed and predicted levels (surge component)\n\n\nThis visualization helps identify when barrier closures occurred relative to predicted high waters and actual water levels.\n\n\nLoading data...\n\nData loaded:\n  Closure dates: 31 closures\n    First closure: 1986-10-20 00:00:00\n    Last closure: 2023-12-21 00:00:00\n  Time series points: 1,998,576\n  Predicted tides: 1,998,576\n  Observed water levels: 1,998,576\n\n\n\nVisualization\nThis figure shows predicted astronomical tides (red), observed water levels (blue), the difference between them (green), and barrier closure dates (vertical dashed magenta lines). The difference (WLP-TIP) represents the non-tidal component, primarily storm surge.\n\n\n\n\n\nPredicted high waters, observed water levels, and barrier closures for the Eastern Scheldt\n\n\n\n\n\nFigure saved to output/master4_predicted_high_waters.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;"
  },
  {
    "objectID": "eastern_scheldt.html#storm-1",
    "href": "eastern_scheldt.html#storm-1",
    "title": "Eastern Scheldt Barrier",
    "section": "Storm 1",
    "text": "Storm 1\n\nWater Level and Surge Analysis\n\n\n\n\n\nPredicted high waters, observed water levels, and barrier closure (zoomed view) for Storm 1 - Eastern Scheldt\n\n\n\n\nFigure saved to output/high_waters_storm1_predicted_high_waters_zoomed.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;\n\n\n\n\n\n\n\nWater level and surge time series for Storm 1 closure event\n\n\n\n\nFigure saved to output/high_waters_storm1_water_level_surge.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;\n\n\n\n\nSpatial Surge and Meteorological Maps\n\nimport imageio\nfrom io import BytesIO\n\ngif_dir = \"output/gif_frames\"\ngif_file_gtsm = \"output/maps_storm1_gtsm_surge.gif\"\nos.makedirs(os.path.dirname(gif_file_gtsm), exist_ok=True)\n\nframes = []\nvmin = -0.5\nvmax = 1.0\n\nfor t_idx in t_gtsm:\n    fig, ax = plt.subplots(figsize=(8, 8))\n    scatter = ax.scatter(X_GT, Y_GT, c=SU_GT[t_idx, :], cmap='jet', s=15, vmin=vmin, vmax=vmax)\n    ax.set_xlim(XB_GTSM)\n    ax.set_ylim(YB_GTSM)\n    ax.set_aspect('equal')\n    ax.grid(True, alpha=0.3)\n    ax.tick_params(labelsize=12)\n    ax.set_title('Surge: ' + TS_GT[t_idx].strftime('%Y-%m-%d %H:%M'), fontweight='bold', fontsize=16)\n    ax.set_xlabel('Longitude (deg)', fontweight='bold', fontsize=14)\n    ax.set_ylabel('Latitude (deg)', fontweight='bold', fontsize=14)\n    cbar = plt.colorbar(scatter, ax=ax, orientation='vertical', fraction=0.046, pad=0.04)\n    cbar.set_label('Surge (m)', fontweight='bold', fontsize=12)\n    cbar.ax.tick_params(labelsize=10)\n    plt.tight_layout()\n\n    # Save to buffer and append as frame\n    buf = BytesIO()\n    fig.savefig(buf, format='png', bbox_inches='tight', dpi=100)\n    buf.seek(0)\n    img = imageio.imread(buf)\n    frames.append(img)\n    buf.close()\n    plt.close(fig)\n\n# Save GIF\nimageio.mimsave(gif_file_gtsm, frames, duration=1.2)\nprint(f\"GTSM surge GIF saved to {gif_file_gtsm}\")\n\n/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_80936/3380865741.py:32: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n  img = imageio.imread(buf)\n\n\nGTSM surge GIF saved to output/maps_storm1_gtsm_surge.gif\n\n\n\nimport imageio\nfrom io import BytesIO\n\n# Create output directory for GIFs (new clean folder)\ngif_output_dir = os.path.join(output_dir, 'storm_era5_gifs')\nos.makedirs(gif_output_dir, exist_ok=True)\n\ngif_file_era5 = os.path.join(gif_output_dir, 'era5_meteorology_storm1.gif')\n\nint_skip = 3\nX_sub = X_MET[lon_idx[0]:lon_idx[-1]+1, lat_idx[0]:lat_idx[-1]+1]\nY_sub = Y_MET[lon_idx[0]:lon_idx[-1]+1, lat_idx[0]:lat_idx[-1]+1]\nX_vec = X_MET[lon_idx[0]:lon_idx[-1]+1:int_skip, lat_idx[0]:lat_idx[-1]+1:int_skip]\nY_vec = Y_MET[lon_idx[0]:lon_idx[-1]+1:int_skip, lat_idx[0]:lat_idx[-1]+1:int_skip]\n\nframes = []\nvmin = 967\nvmax = 1020\n\nfor t_idx in t_met:\n    fig = plt.figure(figsize=(12, 10))\n    ax = plt.axes(projection=ccrs.PlateCarree())\n    \n    # Add coastlines and geographic features\n    ax.add_feature(cfeature.COASTLINE.with_scale('50m'), linewidth=0.8, color='white')\n    ax.add_feature(cfeature.BORDERS.with_scale('50m'), linewidth=0.5, color='white')\n    ax.add_feature(cfeature.LAND.with_scale('50m'), facecolor='lightgray', alpha=0.3)\n    \n    # Get data for this time step\n    P_sub = P_MET[lon_idx[0]:lon_idx[-1]+1, lat_idx[0]:lat_idx[-1]+1, t_idx] / 100\n    U_vec = U_MET[lon_idx[0]:lon_idx[-1]+1:int_skip, lat_idx[0]:lat_idx[-1]+1:int_skip, t_idx]\n    V_vec = V_MET[lon_idx[0]:lon_idx[-1]+1:int_skip, lat_idx[0]:lat_idx[-1]+1:int_skip, t_idx]\n    \n    # Plot pressure field\n    im = ax.pcolormesh(X_sub, Y_sub, P_sub, cmap='jet', shading='gouraud', \n                       vmin=vmin, vmax=vmax, transform=ccrs.PlateCarree())\n    \n    # Plot wind vectors\n    ax.quiver(X_vec, Y_vec, U_vec, V_vec, color='k', scale=1200, width=0.002, \n              transform=ccrs.PlateCarree())\n    \n    # Formatting\n    ax.set_xlim(XB_MET)\n    ax.set_ylim(YB_MET)\n    ax.gridlines(draw_labels=True, linewidth=0.5, color='gray', alpha=0.5, linestyle='--')\n    ax.tick_params(labelsize=12)\n    ax.set_xlabel('Longitude (deg)', fontweight='bold', fontsize=14)\n    ax.set_ylabel('Latitude (deg)', fontweight='bold', fontsize=14)\n    ax.set_title(TS_MET[t_idx].strftime('%Y-%m-%d %H:%M'), fontweight='bold', fontsize=16)\n    \n    # Add colorbar\n    cbar = plt.colorbar(im, ax=ax, fraction=0.046, pad=0.04, shrink=0.6)\n    cbar.set_label('Pressure (hPa)', fontweight='bold', fontsize=12)\n    cbar.ax.tick_params(labelsize=10)\n    \n    plt.tight_layout()\n    \n    # Save to buffer and append as frame\n    buf = BytesIO()\n    fig.savefig(buf, format='png', bbox_inches='tight', dpi=100)\n    buf.seek(0)\n    img = imageio.imread(buf)\n    frames.append(img)\n    buf.close()\n    plt.close(fig)\n\n# Save GIF with fps=0.5 (duration=2.0 seconds per frame)\n# Note: imageio.mimsave uses duration parameter (seconds per frame)\nimageio.mimsave(gif_file_era5, frames, fps=0.5, loop=0)\nprint(f\"ERA5 meteorology GIF saved to {gif_file_era5}\")\n\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_80936/2378499638.py:62: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n  img = imageio.imread(buf)\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_80936/2378499638.py:62: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n  img = imageio.imread(buf)\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_80936/2378499638.py:62: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n  img = imageio.imread(buf)\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_80936/2378499638.py:62: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n  img = imageio.imread(buf)\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_80936/2378499638.py:62: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n  img = imageio.imread(buf)\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n\n\nERA5 meteorology GIF saved to output/storm_era5_gifs/era5_meteorology_storm1.gif\n\n\n/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_80936/2378499638.py:62: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n  img = imageio.imread(buf)\n\n\n\n\n\n\n\n\nFigure 1: ERA5 reanalysis pressure and wind fields animation around Storm 1 closure event"
  },
  {
    "objectID": "eastern_scheldt.html#storm-2",
    "href": "eastern_scheldt.html#storm-2",
    "title": "Eastern Scheldt Barrier",
    "section": "Storm 2",
    "text": "Storm 2\n\nWater Level and Surge Analysis\n\n\n\n\n\nPredicted high waters, observed water levels, and barrier closure (zoomed view) for Storm 2 - Eastern Scheldt\n\n\n\n\nFigure saved to output/high_waters_storm2_predicted_high_waters_zoomed.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;\n\n\n\n\n\n\n\nWater level and surge time series for Storm 2 closure event\n\n\n\n\nFigure saved to output/high_waters_storm2_water_level_surge.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;\n\n\n\n\nSpatial Surge and Meteorological Maps\n\n\n/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_80936/3422602430.py:24: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  plt.tight_layout(rect=[0, 0, 0.97, 1])\n\n\n\n\n\nGTSM reanalysis surge maps at 6 time steps around Storm 2 closure event\n\n\n\n\nFigure saved to output/maps_storm2_gtsm_surge.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;\n\n\n\n\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_80936/807461205.py:42: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  plt.tight_layout(rect=[0, 0, 0.97, 1])\n\n\n\n\n\nERA5 reanalysis pressure and wind fields at 6 time steps around Storm 2 closure event\n\n\n\n\nFigure saved to output/maps_storm2_era5_meteorology.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;"
  },
  {
    "objectID": "eastern_scheldt.html#storm-3",
    "href": "eastern_scheldt.html#storm-3",
    "title": "Eastern Scheldt Barrier",
    "section": "Storm 3",
    "text": "Storm 3\n\nWater Level and Surge Analysis\n\n\n\n\n\nPredicted high waters, observed water levels, and barrier closure (zoomed view) for Storm 3 - Eastern Scheldt\n\n\n\n\nFigure saved to output/high_waters_storm3_predicted_high_waters_zoomed.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;\n\n\n\n\n\n\n\nWater level and surge time series for Storm 3 closure event\n\n\n\n\nFigure saved to output/high_waters_storm3_water_level_surge.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;\n\n\n\n\nSpatial Surge and Meteorological Maps\n\n\n/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_80936/3367164277.py:24: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  plt.tight_layout(rect=[0, 0, 0.97, 1])\n\n\n\n\n\nGTSM reanalysis surge maps at 6 time steps around Storm 3 closure event\n\n\n\n\nFigure saved to output/maps_storm3_gtsm_surge.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;\n\n\n\n\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_80936/86702048.py:42: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  plt.tight_layout(rect=[0, 0, 0.97, 1])\n\n\n\n\n\nERA5 reanalysis pressure and wind fields at 6 time steps around Storm 3 closure event\n\n\n\n\nFigure saved to output/maps_storm3_era5_meteorology.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;"
  },
  {
    "objectID": "eastern_scheldt.html#storm-5",
    "href": "eastern_scheldt.html#storm-5",
    "title": "Eastern Scheldt Barrier",
    "section": "Storm 5",
    "text": "Storm 5\n\nWater Level and Surge Analysis\n\n\n\n\n\nPredicted high waters, observed water levels, and barrier closure (zoomed view) for Storm 5 - Eastern Scheldt\n\n\n\n\nFigure saved to output/high_waters_storm5_predicted_high_waters_zoomed.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;\n\n\n\n\n\n\n\nWater level and surge time series for Storm 5 closure event\n\n\n\n\nFigure saved to output/high_waters_storm5_water_level_surge.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;\n\n\n\n\nSpatial Surge and Meteorological Maps\n\n\n/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_80936/1456226599.py:24: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  plt.tight_layout(rect=[0, 0, 0.97, 1])\n\n\n\n\n\nGTSM reanalysis surge maps at 6 time steps around Storm 5 closure event\n\n\n\n\nFigure saved to output/maps_storm5_gtsm_surge.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;\n\n\n\n\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_80936/2284480292.py:42: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  plt.tight_layout(rect=[0, 0, 0.97, 1])\n\n\n\n\n\nERA5 reanalysis pressure and wind fields at 6 time steps around Storm 5 closure event\n\n\n\n\nFigure saved to output/maps_storm5_era5_meteorology.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;"
  },
  {
    "objectID": "eastern_scheldt.html#storm-6",
    "href": "eastern_scheldt.html#storm-6",
    "title": "Eastern Scheldt Barrier",
    "section": "Storm 6",
    "text": "Storm 6\n\nWater Level and Surge Analysis\n\n\n\n\n\nPredicted high waters, observed water levels, and barrier closure (zoomed view) for Storm 6 - Eastern Scheldt\n\n\n\n\nFigure saved to output/high_waters_storm6_predicted_high_waters_zoomed.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;\n\n\n\n\n\n\n\nWater level and surge time series for Storm 6 closure event\n\n\n\n\nFigure saved to output/high_waters_storm6_water_level_surge.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;\n\n\n\n\nSpatial Surge and Meteorological Maps\n\n\n/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_80936/3290841739.py:24: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  plt.tight_layout(rect=[0, 0, 0.97, 1])\n\n\n\n\n\nGTSM reanalysis surge maps at 6 time steps around Storm 6 closure event\n\n\n\n\nFigure saved to output/maps_storm6_gtsm_surge.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;\n\n\n\n\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_80936/1985222966.py:42: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  plt.tight_layout(rect=[0, 0, 0.97, 1])\n\n\n\n\n\nERA5 reanalysis pressure and wind fields at 6 time steps around Storm 6 closure event\n\n\n\n\nFigure saved to output/maps_storm6_era5_meteorology.png\n\n\n&lt;Figure size 672x480 with 0 Axes&gt;"
  }
]