<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Eastern Scheldt Barrier – Objective1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-01c78b5cd655e4cd89133cf59d535862.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-1322888c997fad56b0b4d776d35cf542.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Objective1</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./eastern_scheldt.html" aria-current="page"> 
<span class="menu-text">Eastern Scheldt Barrier</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./thames.html"> 
<span class="menu-text">Thames Barrier</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#barrier-closures" id="toc-barrier-closures" class="nav-link" data-scroll-target="#barrier-closures">Barrier Closures</a>
  <ul class="collapse">
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis">Analysis</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization">Visualization</a></li>
  </ul></li>
  <li><a href="#tidal-harmonic-analysis" id="toc-tidal-harmonic-analysis" class="nav-link" data-scroll-target="#tidal-harmonic-analysis">Tidal Harmonic Analysis</a>
  <ul class="collapse">
  <li><a href="#tide-gauge-data-processing" id="toc-tide-gauge-data-processing" class="nav-link" data-scroll-target="#tide-gauge-data-processing">Tide Gauge Data Processing</a>
  <ul class="collapse">
  <li><a href="#load-rpbu-1987-2022-data" id="toc-load-rpbu-1987-2022-data" class="nav-link" data-scroll-target="#load-rpbu-1987-2022-data">Load RPBU 1987-2022 Data</a></li>
  <li><a href="#load-rpbu-2023-data" id="toc-load-rpbu-2023-data" class="nav-link" data-scroll-target="#load-rpbu-2023-data">Load RPBU 2023 Data</a></li>
  <li><a href="#load-os4-1982-2023-data" id="toc-load-os4-1982-2023-data" class="nav-link" data-scroll-target="#load-os4-1982-2023-data">Load OS4 1982-2023 Data</a></li>
  <li><a href="#combine-time-series" id="toc-combine-time-series" class="nav-link" data-scroll-target="#combine-time-series">Combine Time Series</a></li>
  <li><a href="#visualization-1" id="toc-visualization-1" class="nav-link" data-scroll-target="#visualization-1">Visualization</a></li>
  </ul></li>
  <li><a href="#tidal-analysis" id="toc-tidal-analysis" class="nav-link" data-scroll-target="#tidal-analysis">Tidal Analysis</a>
  <ul class="collapse">
  <li><a href="#setup-and-configuration" id="toc-setup-and-configuration" class="nav-link" data-scroll-target="#setup-and-configuration">Setup and Configuration</a></li>
  <li><a href="#load-tide-gauge-data" id="toc-load-tide-gauge-data" class="nav-link" data-scroll-target="#load-tide-gauge-data">Load Tide Gauge Data</a></li>
  <li><a href="#calculate-data-quality-per-year" id="toc-calculate-data-quality-per-year" class="nav-link" data-scroll-target="#calculate-data-quality-per-year">Calculate Data Quality Per Year</a></li>
  <li><a href="#tidal-analysis-and-prediction" id="toc-tidal-analysis-and-prediction" class="nav-link" data-scroll-target="#tidal-analysis-and-prediction">Tidal Analysis and Prediction</a></li>
  <li><a href="#visualization-2" id="toc-visualization-2" class="nav-link" data-scroll-target="#visualization-2">Visualization</a></li>
  </ul></li>
  <li><a href="#predicted-high-waters-and-barrier-closures" id="toc-predicted-high-waters-and-barrier-closures" class="nav-link" data-scroll-target="#predicted-high-waters-and-barrier-closures">Predicted High Waters and Barrier Closures</a>
  <ul class="collapse">
  <li><a href="#visualization-3" id="toc-visualization-3" class="nav-link" data-scroll-target="#visualization-3">Visualization</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#storms" id="toc-storms" class="nav-link" data-scroll-target="#storms">Storms</a>
  <ul class="collapse">
  <li><a href="#storm-1" id="toc-storm-1" class="nav-link" data-scroll-target="#storm-1">Storm 1</a>
  <ul class="collapse">
  <li><a href="#water-level-and-surge-analysis" id="toc-water-level-and-surge-analysis" class="nav-link" data-scroll-target="#water-level-and-surge-analysis">Water Level and Surge Analysis</a></li>
  <li><a href="#spatial-surge-and-meteorological-maps" id="toc-spatial-surge-and-meteorological-maps" class="nav-link" data-scroll-target="#spatial-surge-and-meteorological-maps">Spatial Surge and Meteorological Maps</a></li>
  </ul></li>
  <li><a href="#storm-2" id="toc-storm-2" class="nav-link" data-scroll-target="#storm-2">Storm 2</a>
  <ul class="collapse">
  <li><a href="#water-level-and-surge-analysis-1" id="toc-water-level-and-surge-analysis-1" class="nav-link" data-scroll-target="#water-level-and-surge-analysis-1">Water Level and Surge Analysis</a></li>
  <li><a href="#spatial-surge-and-meteorological-maps-1" id="toc-spatial-surge-and-meteorological-maps-1" class="nav-link" data-scroll-target="#spatial-surge-and-meteorological-maps-1">Spatial Surge and Meteorological Maps</a></li>
  </ul></li>
  <li><a href="#storm-3" id="toc-storm-3" class="nav-link" data-scroll-target="#storm-3">Storm 3</a>
  <ul class="collapse">
  <li><a href="#water-level-and-surge-analysis-2" id="toc-water-level-and-surge-analysis-2" class="nav-link" data-scroll-target="#water-level-and-surge-analysis-2">Water Level and Surge Analysis</a></li>
  <li><a href="#spatial-surge-and-meteorological-maps-2" id="toc-spatial-surge-and-meteorological-maps-2" class="nav-link" data-scroll-target="#spatial-surge-and-meteorological-maps-2">Spatial Surge and Meteorological Maps</a></li>
  </ul></li>
  <li><a href="#storm-5" id="toc-storm-5" class="nav-link" data-scroll-target="#storm-5">Storm 5</a>
  <ul class="collapse">
  <li><a href="#water-level-and-surge-analysis-3" id="toc-water-level-and-surge-analysis-3" class="nav-link" data-scroll-target="#water-level-and-surge-analysis-3">Water Level and Surge Analysis</a></li>
  <li><a href="#spatial-surge-and-meteorological-maps-3" id="toc-spatial-surge-and-meteorological-maps-3" class="nav-link" data-scroll-target="#spatial-surge-and-meteorological-maps-3">Spatial Surge and Meteorological Maps</a></li>
  </ul></li>
  <li><a href="#storm-6" id="toc-storm-6" class="nav-link" data-scroll-target="#storm-6">Storm 6</a>
  <ul class="collapse">
  <li><a href="#water-level-and-surge-analysis-4" id="toc-water-level-and-surge-analysis-4" class="nav-link" data-scroll-target="#water-level-and-surge-analysis-4">Water Level and Surge Analysis</a></li>
  <li><a href="#spatial-surge-and-meteorological-maps-4" id="toc-spatial-surge-and-meteorological-maps-4" class="nav-link" data-scroll-target="#spatial-surge-and-meteorological-maps-4">Spatial Surge and Meteorological Maps</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Eastern Scheldt Barrier</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="overview" class="level1">
<h1>Overview</h1>
<p>This document provides a complete analysis workflow for the Eastern Scheldt barrier system, combining barrier closure analysis, tide gauge data processing, tidal analysis, and visualization. The analysis covers the period from 1986 to 2024 and includes:</p>
<ol type="1">
<li><strong>Barrier Closure Analysis</strong>: Loading and analyzing past barrier closure dates, counting closures per water year, and calculating statistics</li>
<li><strong>Tide Gauge Data Processing</strong>: Loading and combining tide gauge data from multiple sources (OS4 and RPBU gauges)</li>
<li><strong>Tidal Analysis</strong>: Performing harmonic tidal decomposition and generating predicted astronomical tides</li>
<li><strong>Visualization</strong>: Creating comprehensive visualizations showing predicted high waters, observed water levels, and barrier closures</li>
</ol>
<p>Water years run from July 1 to June 30, which is more appropriate for coastal flood analysis than calendar years.</p>
<div id="shared-utilities" class="cell" data-execution_count="1">
<div class="cell-output cell-output-stdout">
<pre><code>Shared utilities and configuration loaded</code></pre>
</div>
</div>
<hr>
</section>
<section id="barrier-closures" class="level1">
<h1>Barrier Closures</h1>
<p>This section analyzes past closures of the Eastern Scheldt barrier. The analysis:</p>
<ol type="1">
<li>Loads barrier closure dates from an Excel file</li>
<li>Counts closures per water year (July 1 to July 1)</li>
<li>Calculates statistics (min, mean, max, total closures)</li>
<li>Creates a bar chart visualization</li>
</ol>
<div id="setup-master1" class="cell" data-execution_count="2">
<div class="cell-output cell-output-stdout">
<pre><code>Analysis configuration:
  Water years: 1986/87 to 2024/25 (39 years)</code></pre>
</div>
</div>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<div id="load-closures" class="cell" data-execution_count="3">
<div class="cell-output cell-output-stdout">
<pre><code>Loaded 31 closure datetimes
  First closure: 1986-10-20 00:00:00
  Last closure: 2023-12-21 00:00:00

Closures per water year calculated for 39 years
  Total closures: 31

Closure statistics:
  Min per year: 0.0
  Mean per year: 0.79
  Max per year: 4.0
  Total: 31

Data saved to output/mast1.pkl</code></pre>
</div>
</div>
</section>
<section id="visualization" class="level2">
<h2 class="anchored" data-anchor-id="visualization">Visualization</h2>
<p>This bar chart shows the number of barrier closures per water year from 1986/87 to 2024/25. The Eastern Scheldt barrier closes when water levels exceed a threshold, typically during storm surge events.</p>
<div id="plot-closures" class="cell" data-fig-height="6" data-fig-width="12" data-execution_count="4">
<div class="cell-output cell-output-display">
<div id="plot-closures-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-closures-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Number of Eastern Scheldt barrier closures per water year (July 1 to June 30), 1986-2024</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Figure saved to output/master1_closures.png</code></pre>
</div>
<div id="plot-closures-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
<p>The following table lists all barrier closure dates, which correspond to storm events that triggered the Eastern Scheldt barrier.</p>
<div class="cell" data-execution_count="5">
<div class="cell-output cell-output-stdout">
<pre><code>
Total number of closures: 31</code></pre>
</div>
<div id="table-storms" class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<caption>Complete list of Eastern Scheldt barrier closures (storm events), 1986-2024</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Closure date</th>
<th data-quarto-table-cell-role="th">Closure Date</th>
<th data-quarto-table-cell-role="th">Water Year</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Month</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Closure</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>1986-10-20 00:00</td>
<td>1986/87</td>
<td>1986</td>
<td>October</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>1986-12-19 00:00</td>
<td>1986/87</td>
<td>1986</td>
<td>December</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>1986-12-19 00:00</td>
<td>1986/87</td>
<td>1986</td>
<td>December</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>1989-02-14 05:40</td>
<td>1988/89</td>
<td>1989</td>
<td>February</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>1990-02-27 23:10</td>
<td>1989/90</td>
<td>1990</td>
<td>February</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>4</td>
<td>1990-02-27 13:50</td>
<td>1989/90</td>
<td>1990</td>
<td>February</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>4</td>
<td>1990-02-28 23:40</td>
<td>1989/90</td>
<td>1990</td>
<td>February</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>5</td>
<td>1990-03-01 00:10</td>
<td>1989/90</td>
<td>1990</td>
<td>March</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>6</td>
<td>1990-09-21 12:00</td>
<td>1990/91</td>
<td>1990</td>
<td>September</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>7</td>
<td>1990-12-12 05:40</td>
<td>1990/91</td>
<td>1990</td>
<td>December</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>7</td>
<td>1990-12-12 20:10</td>
<td>1990/91</td>
<td>1990</td>
<td>December</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>8</td>
<td>1992-11-11 13:40</td>
<td>1992/93</td>
<td>1992</td>
<td>November</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>9</td>
<td>1993-01-25 15:30</td>
<td>1992/93</td>
<td>1993</td>
<td>January</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>10</td>
<td>1993-02-21 08:40</td>
<td>1992/93</td>
<td>1993</td>
<td>February</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>11</td>
<td>1993-11-14 11:10</td>
<td>1993/94</td>
<td>1993</td>
<td>November</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>11</td>
<td>1993-11-15 00:40</td>
<td>1993/94</td>
<td>1993</td>
<td>November</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>12</td>
<td>1994-01-28 10:40</td>
<td>1993/94</td>
<td>1994</td>
<td>January</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>13</td>
<td>1995-01-02 21:40</td>
<td>1994/95</td>
<td>1995</td>
<td>January</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>13</td>
<td>1995-01-02 14:20</td>
<td>1994/95</td>
<td>1995</td>
<td>January</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>14</td>
<td>1996-10-29 11:40</td>
<td>1996/97</td>
<td>1996</td>
<td>October</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>15</td>
<td>2002-10-27 14:30</td>
<td>2002/03</td>
<td>2002</td>
<td>October</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>16</td>
<td>2003-12-21 08:30</td>
<td>2003/04</td>
<td>2003</td>
<td>December</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>17</td>
<td>2004-02-08 13:20</td>
<td>2003/04</td>
<td>2004</td>
<td>February</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>18</td>
<td>2007-11-09 22:40</td>
<td>2007/08</td>
<td>2007</td>
<td>November</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>19</td>
<td>2013-12-05 22:50</td>
<td>2013/14</td>
<td>2013</td>
<td>December</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>20</td>
<td>2014-10-21 22:30</td>
<td>2014/15</td>
<td>2014</td>
<td>October</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>21</td>
<td>2018-01-03 12:10</td>
<td>2017/18</td>
<td>2018</td>
<td>January</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>22</td>
<td>2020-02-10 11:09</td>
<td>2019/20</td>
<td>2020</td>
<td>February</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>23</td>
<td>2022-01-31 10:23</td>
<td>2021/22</td>
<td>2022</td>
<td>January</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>24</td>
<td>2022-02-21 04:46</td>
<td>2021/22</td>
<td>2022</td>
<td>February</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>25</td>
<td>2023-12-21 00:00</td>
<td>2023/24</td>
<td>2023</td>
<td>December</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
</section>
</section>
<section id="tidal-harmonic-analysis" class="level1">
<h1>Tidal Harmonic Analysis</h1>
<p>This section performs comprehensive tidal harmonic analysis on tide gauge data from the Eastern Scheldt, including data processing, harmonic decomposition, and visualization. The analysis:</p>
<ol type="1">
<li>Loads and processes raw tide gauge data from multiple sources (OS4 and RPBU gauges)</li>
<li>Performs harmonic tidal decomposition using <code>pytides</code></li>
<li>Generates tidal predictions for all years</li>
<li>Compares observed water levels with predicted astronomical tides</li>
<li>Visualizes predicted high waters and barrier closures</li>
</ol>
<p>The predicted tides represent only the astronomical component, while observed water levels include both tides and meteorological effects (storm surges, wind setup, etc.).</p>
<section id="tide-gauge-data-processing" class="level2">
<h2 class="anchored" data-anchor-id="tide-gauge-data-processing">Tide Gauge Data Processing</h2>
<p>This section loads and processes raw tide gauge data from the Eastern Scheldt. The analysis:</p>
<ol type="1">
<li>Loads data from multiple tide gauge files (RPBU and OS4 gauges)</li>
<li>Cleans data by removing invalid values</li>
<li>Combines time series from different gauges to create a continuous record</li>
<li>Creates a visualization of the complete water level time series</li>
</ol>
<p>The combined time series spans from 1986 to 2023, using OS4 gauge data for the early period (1986-1987) and RPBU gauge data for the main period (1987-2023).</p>
<div id="setup-master2" class="cell" data-execution_count="6">
<div class="cell-output cell-output-stdout">
<pre><code>Data directory: ../2_DATA
Output directory: output</code></pre>
</div>
</div>
<section id="load-rpbu-1987-2022-data" class="level3">
<h3 class="anchored" data-anchor-id="load-rpbu-1987-2022-data">Load RPBU 1987-2022 Data</h3>
<p>Load the main tide gauge dataset from the RPBU gauge covering April 1987 to December 2022.</p>
<div id="load-rpbu-1987-2022" class="cell" data-execution_count="7">
<div class="cell-output cell-output-stdout">
<pre><code>Loaded RPBU 1987-2022: 1,878,480 data points
  Start: 1987-04-15 00:00:00
  End: 2022-12-31 23:50:00
  Valid data: 1,876,721 points (99.9%)</code></pre>
</div>
</div>
</section>
<section id="load-rpbu-2023-data" class="level3">
<h3 class="anchored" data-anchor-id="load-rpbu-2023-data">Load RPBU 2023 Data</h3>
<p>Load the 2023 data from the RPBU gauge to extend the time series.</p>
<div id="load-rpbu-2023" class="cell" data-execution_count="8">
<div class="cell-output cell-output-stdout">
<pre><code>Loaded RPBU 2023: 52,560 data points
  Start: 2023-01-01 00:00:00
  End: 2023-12-31 23:50:00
  Valid data: 52,560 points (100.0%)</code></pre>
</div>
</div>
</section>
<section id="load-os4-1982-2023-data" class="level3">
<h3 class="anchored" data-anchor-id="load-os4-1982-2023-data">Load OS4 1982-2023 Data</h3>
<p>Load data from the OS4 gauge, which provides coverage for the early period before RPBU data begins.</p>
<div id="load-os4" class="cell" data-execution_count="9">
<div class="cell-output cell-output-stdout">
<pre><code>Loaded OS4 1982-2023: 2,208,960 data points
  Start: 1982-01-01 00:00:00
  End: 2023-12-31 23:50:00
  Valid data: 2,161,485 points (97.9%)</code></pre>
</div>
</div>
</section>
<section id="combine-time-series" class="level3">
<h3 class="anchored" data-anchor-id="combine-time-series">Combine Time Series</h3>
<p>Combine the time series from different gauges to create a continuous record. Use OS4 data for the early period (1986-1987) before RPBU starts, then switch to RPBU data for the main period.</p>
<div id="combine-series" class="cell" data-execution_count="10">
<div class="cell-output cell-output-stdout">
<pre><code>
Combined time series: 1,998,576 data points
  Start: 1986-01-01 00:00:00
  End: 2023-12-31 23:50:00
  Valid data: 1,996,699 points (99.9%)
  Time span: 13878 days</code></pre>
</div>
</div>
<p>Save the combined time series to a pickle file for use in subsequent analyses.</p>
<div id="save-master2" class="cell" data-execution_count="11">
<div class="cell-output cell-output-stdout">
<pre><code>
Data saved to output/mast2.pkl</code></pre>
</div>
</div>
</section>
<section id="visualization-1" class="level3">
<h3 class="anchored" data-anchor-id="visualization-1">Visualization</h3>
<p>This figure shows the combined tide gauge water level time series from 1986 to 2023 at 10-minute intervals. The data combines OS4 gauge measurements (1986-1987) and RPBU gauge measurements (1987-2023) for the Eastern Scheldt. Water levels are shown in meters relative to NAP (Normal Amsterdam Peil, the Dutch reference datum). The time series shows tidal variations, storm surges, and long-term water level patterns over the 38-year period.</p>
<div id="plot-time-series" class="cell" data-fig-height="6" data-fig-width="14" data-execution_count="12">
<div class="cell-output cell-output-display">
<div id="plot-time-series-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-time-series-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Combined tide gauge water level time series for the Eastern Scheldt, 1986-2023. Data combines OS4 gauge (1986-1987) and RPBU gauge (1987-2023) measurements at 10-minute intervals.</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Figure saved to output/master2_tide_gauge.png</code></pre>
</div>
<div id="plot-time-series-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="tidal-analysis" class="level2">
<h2 class="anchored" data-anchor-id="tidal-analysis">Tidal Analysis</h2>
<p>This section performs harmonic tidal analysis on tide gauge data from the Eastern Scheldt. The analysis:</p>
<ol type="1">
<li>Calculates data quality for each year (1986-2023)</li>
<li>Performs harmonic tidal decomposition using <code>pytides</code> (replacing MATLAB’s <code>t_tide</code>)</li>
<li>Generates tidal predictions for all years</li>
<li>Compares observed water levels with predicted astronomical tides</li>
</ol>
<p>The predicted tides represent only the astronomical component, while observed water levels include both tides and meteorological effects (storm surges, wind setup, etc.).</p>
<section id="setup-and-configuration" class="level3">
<h3 class="anchored" data-anchor-id="setup-and-configuration">Setup and Configuration</h3>
<div id="setup-master3" class="cell" data-execution_count="13">
<div class="cell-output cell-output-stdout">
<pre><code>Analysis configuration:
  Years: 1986 to 2023 (38 years)
  Data quality threshold: 60%
  Latitude: 51.64°</code></pre>
</div>
</div>
</section>
<section id="load-tide-gauge-data" class="level3">
<h3 class="anchored" data-anchor-id="load-tide-gauge-data">Load Tide Gauge Data</h3>
<div id="load-data-master3" class="cell" data-execution_count="14">
<div class="cell-output cell-output-stdout">
<pre><code>Loading tide gauge data...
Loaded 1,998,576 data points
  Start: 1986-01-01 00:00:00
  End: 2023-12-31 23:50:00
  Valid data: 1,996,699 points (99.9%)</code></pre>
</div>
</div>
</section>
<section id="calculate-data-quality-per-year" class="level3">
<h3 class="anchored" data-anchor-id="calculate-data-quality-per-year">Calculate Data Quality Per Year</h3>
<div id="data-quality" class="cell" data-execution_count="15">
<div class="cell-output cell-output-stdout">
<pre><code>
Calculating data quality per year...

Data quality summary:
  Range: 98.8% to 100.0%
  Mean: 99.9%
  Years with quality &gt;= 60%: 38/38</code></pre>
</div>
</div>
</section>
<section id="tidal-analysis-and-prediction" class="level3">
<h3 class="anchored" data-anchor-id="tidal-analysis-and-prediction">Tidal Analysis and Prediction</h3>
<p>For each target year, the analysis determines a reference year, extracts data, performs harmonic decomposition, and generates predictions.</p>
<div id="tidal-analysis" class="cell" data-execution_count="16">
<div class="cell-output cell-output-stdout">
<pre><code>
Loading existing tidal analysis results...
Loaded existing results:
  Total predictions: 1,998,576 points
  Start: 1986-01-01 00:00:00
  End: 2023-12-31 23:50:00</code></pre>
</div>
</div>
<div id="save-master3" class="cell" data-execution_count="17">
<div class="cell-output cell-output-stdout">
<pre><code>Data saved to output/mast3.pkl</code></pre>
</div>
</div>
</section>
<section id="visualization-2" class="level3">
<h3 class="anchored" data-anchor-id="visualization-2">Visualization</h3>
<p>This figure compares observed water levels (blue) with predicted astronomical tides (red) from harmonic analysis. The predicted tides represent the astronomical component only, while observed water levels include both tides and meteorological effects.</p>
<div id="plot-comparison" class="cell" data-fig-height="6" data-fig-width="14" data-execution_count="18">
<div class="cell-output cell-output-display">
<div id="plot-comparison-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-comparison-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Comparison of observed water levels (blue) and predicted astronomical tides (red) for the Eastern Scheldt, 1986-2023</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Figure saved to output/master3_tidal_analysis.png</code></pre>
</div>
<div id="plot-comparison-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="predicted-high-waters-and-barrier-closures" class="level2">
<h2 class="anchored" data-anchor-id="predicted-high-waters-and-barrier-closures">Predicted High Waters and Barrier Closures</h2>
<p>This section plots time-series of predicted high waters and barrier closures for the Eastern Scheldt. The analysis:</p>
<ol type="1">
<li>Loads barrier closure dates and tide gauge data from previous analyses</li>
<li>Creates a visualization showing:
<ul>
<li>Barrier closure dates as vertical dashed lines</li>
<li>Predicted astronomical tides (TIP)</li>
<li>Observed water levels (WLP)</li>
<li>The difference between observed and predicted levels (surge component)</li>
</ul></li>
</ol>
<p>This visualization helps identify when barrier closures occurred relative to predicted high waters and actual water levels.</p>
<div id="load-data-master4" class="cell" data-execution_count="19">
<div class="cell-output cell-output-stdout">
<pre><code>Loading data...

Data loaded:
  Closure dates: 31 closures
    First closure: 1986-10-20 00:00:00
    Last closure: 2023-12-21 00:00:00
  Time series points: 1,998,576
  Predicted tides: 1,998,576
  Observed water levels: 1,998,576</code></pre>
</div>
</div>
<section id="visualization-3" class="level3">
<h3 class="anchored" data-anchor-id="visualization-3">Visualization</h3>
<p>This figure shows predicted astronomical tides (red), observed water levels (blue), the difference between them (green), and barrier closure dates (vertical dashed magenta lines). The difference (WLP-TIP) represents the non-tidal component, primarily storm surge.</p>
<div id="plot-predicted-high-waters" class="cell" data-fig-height="8" data-fig-width="14" data-execution_count="20">
<div class="cell-output cell-output-display">
<div id="plot-predicted-high-waters-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-predicted-high-waters-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Predicted high waters, observed water levels, and barrier closures for the Eastern Scheldt</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Figure saved to output/master4_predicted_high_waters.png</code></pre>
</div>
<div id="plot-predicted-high-waters-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="storms" class="level1">
<h1>Storms</h1>
<div id="load-closure-tide-data" class="cell" data-execution_count="21">
<div class="cell-output cell-output-stdout">
<pre><code>Loading data...

Data loaded:
  Total closure dates: 31 closures
  Time series points: 1,998,576</code></pre>
</div>
</div>
<section id="storm-1" class="level2">
<h2 class="anchored" data-anchor-id="storm-1">Storm 1</h2>
<section id="water-level-and-surge-analysis" class="level3">
<h3 class="anchored" data-anchor-id="water-level-and-surge-analysis">Water Level and Surge Analysis</h3>
<div id="plot-predicted-high-waters-zoomed-storm1" class="cell" data-fig-height="8" data-fig-width="14" data-execution_count="22">
<div class="cell-output cell-output-display">
<div id="plot-predicted-high-waters-zoomed-storm1-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-predicted-high-waters-zoomed-storm1-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Predicted high waters, observed water levels, and barrier closure (zoomed view) for Storm 1 - Eastern Scheldt</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/high_waters_storm1_predicted_high_waters_zoomed.png</code></pre>
</div>
<div id="plot-predicted-high-waters-zoomed-storm1-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
<div id="plot-water-level-surge-storm1" class="cell" data-fig-height="10" data-fig-width="14" data-execution_count="23">
<div class="cell-output cell-output-display">
<div id="plot-water-level-surge-storm1-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-water-level-surge-storm1-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Water level and surge time series for Storm 1 closure event</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/high_waters_storm1_water_level_surge.png</code></pre>
</div>
<div id="plot-water-level-surge-storm1-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
</section>
<section id="spatial-surge-and-meteorological-maps" class="level3">
<h3 class="anchored" data-anchor-id="spatial-surge-and-meteorological-maps">Spatial Surge and Meteorological Maps</h3>
<div id="plot-gtsm-surge-storm1-gif" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> imageio</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> BytesIO</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>gif_dir <span class="op">=</span> <span class="st">"output/gif_frames"</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>gif_file_gtsm <span class="op">=</span> <span class="st">"output/maps_storm1_gtsm_surge.gif"</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>os.makedirs(os.path.dirname(gif_file_gtsm), exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>frames <span class="op">=</span> []</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>vmin <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>vmax <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t_idx <span class="kw">in</span> t_gtsm:</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    scatter <span class="op">=</span> ax.scatter(X_GT, Y_GT, c<span class="op">=</span>SU_GT[t_idx, :], cmap<span class="op">=</span><span class="st">'jet'</span>, s<span class="op">=</span><span class="dv">15</span>, vmin<span class="op">=</span>vmin, vmax<span class="op">=</span>vmax)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(XB_GTSM)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(YB_GTSM)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    ax.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(labelsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">'Surge: '</span> <span class="op">+</span> TS_GT[t_idx].strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M'</span>), fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'Longitude (deg)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Latitude (deg)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    cbar <span class="op">=</span> plt.colorbar(scatter, ax<span class="op">=</span>ax, orientation<span class="op">=</span><span class="st">'vertical'</span>, fraction<span class="op">=</span><span class="fl">0.046</span>, pad<span class="op">=</span><span class="fl">0.04</span>)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    cbar.set_label(<span class="st">'Surge (m)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    cbar.ax.tick_params(labelsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save to buffer and append as frame</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>    buf <span class="op">=</span> BytesIO()</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>    fig.savefig(buf, <span class="bu">format</span><span class="op">=</span><span class="st">'png'</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, dpi<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>    buf.seek(<span class="dv">0</span>)</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>    img <span class="op">=</span> imageio.imread(buf)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>    frames.append(img)</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>    buf.close()</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>    plt.close(fig)</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Save GIF</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>imageio.mimsave(gif_file_gtsm, frames, fps<span class="op">=</span><span class="dv">1</span>, loop<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"GTSM surge GIF saved to </span><span class="sc">{</span>gif_file_gtsm<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_83008/1323197270.py:32: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.
  img = imageio.imread(buf)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>GTSM surge GIF saved to output/maps_storm1_gtsm_surge.gif</code></pre>
</div>
</div>
<div id="fig-era5-met-storm1-gif" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-cap="ERA5 reanalysis pressure and wind fields animation around Storm 1 closure event">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-era5-met-storm1-gif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="output/maps_storm1_gtsm_surge.gif" class="img-fluid figure-img" data-fig-cap="ERA5 reanalysis pressure and wind fields animation around Storm 1 closure event">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-era5-met-storm1-gif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: GTSM storm surge animation around Storm 1 closure event
</figcaption>
</figure>
</div>
<div id="plot-era5-met-storm1-gif" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> imageio</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> BytesIO</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create output directory for GIFs (new clean folder)</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>gif_output_dir <span class="op">=</span> os.path.join(output_dir, <span class="st">'storm_era5_gifs'</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>os.makedirs(gif_output_dir, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>gif_file_era5 <span class="op">=</span> os.path.join(gif_output_dir, <span class="st">'era5_meteorology_storm1.gif'</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>int_skip <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>X_sub <span class="op">=</span> X_MET[lon_idx[<span class="dv">0</span>]:lon_idx[<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span>, lat_idx[<span class="dv">0</span>]:lat_idx[<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>Y_sub <span class="op">=</span> Y_MET[lon_idx[<span class="dv">0</span>]:lon_idx[<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span>, lat_idx[<span class="dv">0</span>]:lat_idx[<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>X_vec <span class="op">=</span> X_MET[lon_idx[<span class="dv">0</span>]:lon_idx[<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span>:int_skip, lat_idx[<span class="dv">0</span>]:lat_idx[<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span>:int_skip]</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>Y_vec <span class="op">=</span> Y_MET[lon_idx[<span class="dv">0</span>]:lon_idx[<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span>:int_skip, lat_idx[<span class="dv">0</span>]:lat_idx[<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span>:int_skip]</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>frames <span class="op">=</span> []</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>vmin <span class="op">=</span> <span class="dv">967</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>vmax <span class="op">=</span> <span class="dv">1020</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t_idx <span class="kw">in</span> t_met:</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> plt.axes(projection<span class="op">=</span>ccrs.PlateCarree())</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add coastlines and geographic features</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    ax.add_feature(cfeature.COASTLINE.with_scale(<span class="st">'50m'</span>), linewidth<span class="op">=</span><span class="fl">0.8</span>, color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    ax.add_feature(cfeature.BORDERS.with_scale(<span class="st">'50m'</span>), linewidth<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    ax.add_feature(cfeature.LAND.with_scale(<span class="st">'50m'</span>), facecolor<span class="op">=</span><span class="st">'lightgray'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get data for this time step</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>    P_sub <span class="op">=</span> P_MET[lon_idx[<span class="dv">0</span>]:lon_idx[<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span>, lat_idx[<span class="dv">0</span>]:lat_idx[<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span>, t_idx] <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    U_vec <span class="op">=</span> U_MET[lon_idx[<span class="dv">0</span>]:lon_idx[<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span>:int_skip, lat_idx[<span class="dv">0</span>]:lat_idx[<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span>:int_skip, t_idx]</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>    V_vec <span class="op">=</span> V_MET[lon_idx[<span class="dv">0</span>]:lon_idx[<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span>:int_skip, lat_idx[<span class="dv">0</span>]:lat_idx[<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span>:int_skip, t_idx]</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot pressure field</span></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>    im <span class="op">=</span> ax.pcolormesh(X_sub, Y_sub, P_sub, cmap<span class="op">=</span><span class="st">'jet'</span>, shading<span class="op">=</span><span class="st">'gouraud'</span>, </span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>                       vmin<span class="op">=</span>vmin, vmax<span class="op">=</span>vmax, transform<span class="op">=</span>ccrs.PlateCarree())</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot wind vectors</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>    ax.quiver(X_vec, Y_vec, U_vec, V_vec, color<span class="op">=</span><span class="st">'k'</span>, scale<span class="op">=</span><span class="dv">1200</span>, width<span class="op">=</span><span class="fl">0.002</span>, </span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>              transform<span class="op">=</span>ccrs.PlateCarree())</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Formatting</span></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(XB_MET)</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(YB_MET)</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>    ax.gridlines(draw_labels<span class="op">=</span><span class="va">True</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(labelsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'Longitude (deg)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Latitude (deg)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>    ax.set_title(TS_MET[t_idx].strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M'</span>), fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add colorbar</span></span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>    cbar <span class="op">=</span> plt.colorbar(im, ax<span class="op">=</span>ax, fraction<span class="op">=</span><span class="fl">0.046</span>, pad<span class="op">=</span><span class="fl">0.04</span>, shrink<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>    cbar.set_label(<span class="st">'Pressure (hPa)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>    cbar.ax.tick_params(labelsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save to buffer and append as frame</span></span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>    buf <span class="op">=</span> BytesIO()</span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>    fig.savefig(buf, <span class="bu">format</span><span class="op">=</span><span class="st">'png'</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, dpi<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>    buf.seek(<span class="dv">0</span>)</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>    img <span class="op">=</span> imageio.imread(buf)</span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>    frames.append(img)</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>    buf.close()</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>    plt.close(fig)</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Save GIF with fps=0.5 (duration=2.0 seconds per frame)</span></span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: imageio.mimsave uses duration parameter (seconds per frame)</span></span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>imageio.mimsave(gif_file_era5, frames, fps<span class="op">=</span><span class="dv">1</span>, loop<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"ERA5 meteorology GIF saved to </span><span class="sc">{</span>gif_file_era5<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_83008/3735918726.py:62: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.
  img = imageio.imread(buf)
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_83008/3735918726.py:62: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.
  img = imageio.imread(buf)
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_83008/3735918726.py:62: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.
  img = imageio.imread(buf)
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_83008/3735918726.py:62: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.
  img = imageio.imread(buf)
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_83008/3735918726.py:62: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.
  img = imageio.imread(buf)
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ERA5 meteorology GIF saved to output/storm_era5_gifs/era5_meteorology_storm1.gif</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_83008/3735918726.py:62: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.
  img = imageio.imread(buf)</code></pre>
</div>
</div>
<div id="fig-era5-met-storm1-gif" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-cap="ERA5 reanalysis pressure and wind fields animation around Storm 1 closure event">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-era5-met-storm1-gif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="output/storm_era5_gifs/era5_meteorology_storm1.gif" class="img-fluid figure-img" data-fig-cap="ERA5 reanalysis pressure and wind fields animation around Storm 1 closure event">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-era5-met-storm1-gif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: ERA5 reanalysis pressure and wind fields animation around Storm 1 closure event
</figcaption>
</figure>
</div>
</section>
</section>
<section id="storm-2" class="level2">
<h2 class="anchored" data-anchor-id="storm-2">Storm 2</h2>
<section id="water-level-and-surge-analysis-1" class="level3">
<h3 class="anchored" data-anchor-id="water-level-and-surge-analysis-1">Water Level and Surge Analysis</h3>
<div id="plot-predicted-high-waters-zoomed-storm2" class="cell" data-fig-height="8" data-fig-width="14" data-execution_count="28">
<div class="cell-output cell-output-display">
<div id="plot-predicted-high-waters-zoomed-storm2-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-predicted-high-waters-zoomed-storm2-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Predicted high waters, observed water levels, and barrier closure (zoomed view) for Storm 2 - Eastern Scheldt</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/high_waters_storm2_predicted_high_waters_zoomed.png</code></pre>
</div>
<div id="plot-predicted-high-waters-zoomed-storm2-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
<div id="plot-water-level-surge-storm2" class="cell" data-fig-height="10" data-fig-width="14" data-execution_count="29">
<div class="cell-output cell-output-display">
<div id="plot-water-level-surge-storm2-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-water-level-surge-storm2-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Water level and surge time series for Storm 2 closure event</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/high_waters_storm2_water_level_surge.png</code></pre>
</div>
<div id="plot-water-level-surge-storm2-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
</section>
<section id="spatial-surge-and-meteorological-maps-1" class="level3">
<h3 class="anchored" data-anchor-id="spatial-surge-and-meteorological-maps-1">Spatial Surge and Meteorological Maps</h3>
<div id="plot-gtsm-surge-storm2" class="cell" data-fig-height="10" data-fig-width="16" data-execution_count="32">
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_83008/3422602430.py:24: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout(rect=[0, 0, 0.97, 1])</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="plot-gtsm-surge-storm2-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-gtsm-surge-storm2-output-2.png" class="img-fluid figure-img"></p>
<figcaption>GTSM reanalysis surge maps at 6 time steps around Storm 2 closure event</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/maps_storm2_gtsm_surge.png</code></pre>
</div>
<div id="plot-gtsm-surge-storm2-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
<div id="plot-era5-met-storm2" class="cell" data-fig-height="10" data-fig-width="16" data-execution_count="33">
<div class="cell-output cell-output-stderr">
<pre><code>/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_83008/807461205.py:42: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout(rect=[0, 0, 0.97, 1])</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="plot-era5-met-storm2-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-era5-met-storm2-output-2.png" class="img-fluid figure-img"></p>
<figcaption>ERA5 reanalysis pressure and wind fields at 6 time steps around Storm 2 closure event</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/maps_storm2_era5_meteorology.png</code></pre>
</div>
<div id="plot-era5-met-storm2-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="storm-3" class="level2">
<h2 class="anchored" data-anchor-id="storm-3">Storm 3</h2>
<section id="water-level-and-surge-analysis-2" class="level3">
<h3 class="anchored" data-anchor-id="water-level-and-surge-analysis-2">Water Level and Surge Analysis</h3>
<div id="plot-predicted-high-waters-zoomed-storm3" class="cell" data-fig-height="8" data-fig-width="14" data-execution_count="34">
<div class="cell-output cell-output-display">
<div id="plot-predicted-high-waters-zoomed-storm3-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-predicted-high-waters-zoomed-storm3-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Predicted high waters, observed water levels, and barrier closure (zoomed view) for Storm 3 - Eastern Scheldt</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/high_waters_storm3_predicted_high_waters_zoomed.png</code></pre>
</div>
<div id="plot-predicted-high-waters-zoomed-storm3-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
<div id="plot-water-level-surge-storm3" class="cell" data-fig-height="10" data-fig-width="14" data-execution_count="35">
<div class="cell-output cell-output-display">
<div id="plot-water-level-surge-storm3-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-water-level-surge-storm3-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Water level and surge time series for Storm 3 closure event</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/high_waters_storm3_water_level_surge.png</code></pre>
</div>
<div id="plot-water-level-surge-storm3-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
</section>
<section id="spatial-surge-and-meteorological-maps-2" class="level3">
<h3 class="anchored" data-anchor-id="spatial-surge-and-meteorological-maps-2">Spatial Surge and Meteorological Maps</h3>
<div id="plot-gtsm-surge-storm3" class="cell" data-fig-height="10" data-fig-width="16" data-execution_count="38">
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_83008/3367164277.py:24: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout(rect=[0, 0, 0.97, 1])</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="plot-gtsm-surge-storm3-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-gtsm-surge-storm3-output-2.png" class="img-fluid figure-img"></p>
<figcaption>GTSM reanalysis surge maps at 6 time steps around Storm 3 closure event</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/maps_storm3_gtsm_surge.png</code></pre>
</div>
<div id="plot-gtsm-surge-storm3-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
<div id="plot-era5-met-storm3" class="cell" data-fig-height="10" data-fig-width="16" data-execution_count="39">
<div class="cell-output cell-output-stderr">
<pre><code>/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_83008/86702048.py:42: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout(rect=[0, 0, 0.97, 1])</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="plot-era5-met-storm3-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-era5-met-storm3-output-2.png" class="img-fluid figure-img"></p>
<figcaption>ERA5 reanalysis pressure and wind fields at 6 time steps around Storm 3 closure event</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/maps_storm3_era5_meteorology.png</code></pre>
</div>
<div id="plot-era5-met-storm3-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="storm-5" class="level2">
<h2 class="anchored" data-anchor-id="storm-5">Storm 5</h2>
<section id="water-level-and-surge-analysis-3" class="level3">
<h3 class="anchored" data-anchor-id="water-level-and-surge-analysis-3">Water Level and Surge Analysis</h3>
<div id="plot-predicted-high-waters-zoomed-storm5" class="cell" data-fig-height="8" data-fig-width="14" data-execution_count="40">
<div class="cell-output cell-output-display">
<div id="plot-predicted-high-waters-zoomed-storm5-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-predicted-high-waters-zoomed-storm5-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Predicted high waters, observed water levels, and barrier closure (zoomed view) for Storm 5 - Eastern Scheldt</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/high_waters_storm5_predicted_high_waters_zoomed.png</code></pre>
</div>
<div id="plot-predicted-high-waters-zoomed-storm5-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
<div id="plot-water-level-surge-storm5" class="cell" data-fig-height="10" data-fig-width="14" data-execution_count="41">
<div class="cell-output cell-output-display">
<div id="plot-water-level-surge-storm5-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-water-level-surge-storm5-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Water level and surge time series for Storm 5 closure event</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/high_waters_storm5_water_level_surge.png</code></pre>
</div>
<div id="plot-water-level-surge-storm5-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
</section>
<section id="spatial-surge-and-meteorological-maps-3" class="level3">
<h3 class="anchored" data-anchor-id="spatial-surge-and-meteorological-maps-3">Spatial Surge and Meteorological Maps</h3>
<div id="plot-gtsm-surge-storm5" class="cell" data-fig-height="10" data-fig-width="16" data-execution_count="44">
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_83008/1456226599.py:24: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout(rect=[0, 0, 0.97, 1])</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="plot-gtsm-surge-storm5-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-gtsm-surge-storm5-output-2.png" class="img-fluid figure-img"></p>
<figcaption>GTSM reanalysis surge maps at 6 time steps around Storm 5 closure event</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/maps_storm5_gtsm_surge.png</code></pre>
</div>
<div id="plot-gtsm-surge-storm5-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
<div id="plot-era5-met-storm5" class="cell" data-fig-height="10" data-fig-width="16" data-execution_count="45">
<div class="cell-output cell-output-stderr">
<pre><code>/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_83008/2284480292.py:42: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout(rect=[0, 0, 0.97, 1])</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="plot-era5-met-storm5-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-era5-met-storm5-output-2.png" class="img-fluid figure-img"></p>
<figcaption>ERA5 reanalysis pressure and wind fields at 6 time steps around Storm 5 closure event</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/maps_storm5_era5_meteorology.png</code></pre>
</div>
<div id="plot-era5-met-storm5-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="storm-6" class="level2">
<h2 class="anchored" data-anchor-id="storm-6">Storm 6</h2>
<section id="water-level-and-surge-analysis-4" class="level3">
<h3 class="anchored" data-anchor-id="water-level-and-surge-analysis-4">Water Level and Surge Analysis</h3>
<div id="plot-predicted-high-waters-zoomed-storm6" class="cell" data-fig-height="8" data-fig-width="14" data-execution_count="46">
<div class="cell-output cell-output-display">
<div id="plot-predicted-high-waters-zoomed-storm6-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-predicted-high-waters-zoomed-storm6-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Predicted high waters, observed water levels, and barrier closure (zoomed view) for Storm 6 - Eastern Scheldt</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/high_waters_storm6_predicted_high_waters_zoomed.png</code></pre>
</div>
<div id="plot-predicted-high-waters-zoomed-storm6-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
<div id="plot-water-level-surge-storm6" class="cell" data-fig-height="10" data-fig-width="14" data-execution_count="47">
<div class="cell-output cell-output-display">
<div id="plot-water-level-surge-storm6-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-water-level-surge-storm6-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Water level and surge time series for Storm 6 closure event</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/high_waters_storm6_water_level_surge.png</code></pre>
</div>
<div id="plot-water-level-surge-storm6-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
</section>
<section id="spatial-surge-and-meteorological-maps-4" class="level3">
<h3 class="anchored" data-anchor-id="spatial-surge-and-meteorological-maps-4">Spatial Surge and Meteorological Maps</h3>
<div id="plot-gtsm-surge-storm6" class="cell" data-fig-height="10" data-fig-width="16" data-execution_count="50">
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_83008/3290841739.py:24: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout(rect=[0, 0, 0.97, 1])</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="plot-gtsm-surge-storm6-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-gtsm-surge-storm6-output-2.png" class="img-fluid figure-img"></p>
<figcaption>GTSM reanalysis surge maps at 6 time steps around Storm 6 closure event</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/maps_storm6_gtsm_surge.png</code></pre>
</div>
<div id="plot-gtsm-surge-storm6-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
<div id="plot-era5-met-storm6" class="cell" data-fig-height="10" data-fig-width="16" data-execution_count="51">
<div class="cell-output cell-output-stderr">
<pre><code>/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/opt/miniconda3/envs/objective1/lib/python3.14/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/var/folders/m8/cp78hgjj6j937vhj63cdm7_c0000gn/T/ipykernel_83008/1985222966.py:42: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout(rect=[0, 0, 0.97, 1])</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="plot-era5-met-storm6-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="eastern_scheldt_files/figure-html/plot-era5-met-storm6-output-2.png" class="img-fluid figure-img"></p>
<figcaption>ERA5 reanalysis pressure and wind fields at 6 time steps around Storm 6 closure event</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved to output/maps_storm6_era5_meteorology.png</code></pre>
</div>
<div id="plot-era5-met-storm6-2" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>